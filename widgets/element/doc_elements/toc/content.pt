<init tal:omit-tag=""
      tal:define="global node request/node;
                  global toc_depth python:int(test(node.hasAttribute('toc_depth'),node.getAttribute('toc_depth'),-1))" />

<p>
  <toc tal:omit-tag=""
       tal:repeat="obj python:request.node.get_content().get_container().get_status_tree(int(toc_depth))">
  <loop tal:omit-tag=""
        tal:define="indent python:obj[0]; 
                    item python:obj[1];
                    title python:obj[1].get_title_html()"
        tal:condition="python:toc_depth == -1 or indent &lt; toc_depth" >
  <img width="12" height="10"
       tal:condition="python:indent &gt; 0"
       tal:attributes="width python:indent * 24;
      src string:${here/silva_root}/globals/pixel.gif" />
  <a href="edit" class="toc-link"
     tal:attributes="href string:${item/absolute_url}/edit/tab_edit"
     tal:content="structure title">title</a><br />
  </loop>
  </toc>
</p>
