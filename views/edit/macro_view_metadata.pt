<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html tal:omit-tag=""
  lang="en"
  xml:lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:notal="http://www.infrae.com/silva/notal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  i18n:domain="silva">

<metal:block define-macro="metadata">
<tal:block define="
    ct python: mangle.String.centeredTruncate;
    truncatable python:['location'];
  ">
  <tal:block 
    define="
      metadata_category category | string:;
      binding python: view.get_metadata(content, category=metadata_category) or nothing;
      setnames binding/setNames | nothing;
      is_container model/implements_container | nothing;
      is_versioned model/implements_versioning | nothing;
      is_ghosty python: model.meta_type.startswith('Silva Ghost');
      form_errors options/form_errors | nothing;"
    condition="python: content and setnames"
    >
    <table class="listing"
      tal:condition="binding">
      <thead>
        <tr tal:replace="nothing">
          ______________ vein + title row ______________
        </tr>
        <tr>
          <td class="top" colspan="2">
            <h2 metal:define-slot="table_title" i18n:translate="">
              <img tal:replace="structure python:view.render_icon(model)" />
              metadata
              <span tal:condition="not: model/implements_container" i18n:name="for_title"><span i18:translate="">
                for &#xab;<span tal:replace="string:${title}" i18n:name="title">title</span>&#xbb;</span>
              </span>
            </h2>
          </td>
        </tr>
      </thead>
      <tbody>
        <tal:block repeat="set_name setnames">
          <tr tal:replace="nothing">
            ______________ top controls row ______________
          </tr>
          <tr class="top-controls">
            <td colspan="2">
              <h3>
                <span i18n:translate="">metadata set</span> &#xab;<tal:block replace="binding/?set_name/setTitle | set_name" />&#xbb;
              </h3>
            </td>
          </tr>
          <tr>
            <th class="align-right"
              width="12%" i18n:translate="">
              element
            </th>
            <th i18n:translate="">
              content
            </th>
          </tr>
          <tal:block repeat="element_name binding/?set_name/elementNames">
            <tr 
              tal:define="
                element binding/?set_name/?element_name;                  
                iterate repeat/element_name/odd;
                show_bottom_border repeat/element_name/end;"
              tal:attributes="
                class python: iterate and 'odd' or 'even';
                style python: show_bottom_border and 'border-bottom: 1px solid #77858c' or nothing;">
              <tal:block replace="nothing">
                ___ element name column ___
              </tal:block>
              <td class="align-right"
                tal:content="element/title" i18n:translate="">
                Element name
              </td>
              <tal:block replace="nothing">
                ___ element widget column ___
              </tal:block>
              <td 
                tal:define="
                  data python: element['view'];
                  "
                tal:content="
                  structure data">
                Element content view
              </td>
            </tr>
          </tal:block>
        </tal:block>
        <tal:block>
          <tal:block define="renderer_name content/get_renderer_name" 
            condition="python: request.model.service_renderer_registry.doesRendererExistForMetaType(request.model.meta_type, renderer_name)">
            <tr tal:replace="nothing">
              ______________ top controls row ______________
            </tr>
            <tr class="top-controls">
              <td colspan="4">
                <h3>
                  <span i18n:translate="">content renderer</span>
                </h3>
              </td>
            </tr>
            <tr>
              <tal:block replace="nothing">
                ___ element name column ___
              </tal:block>
              <td class="align-right">
                <tal:block i18n:translate="">
                  renderer
                </tal:block>
              </td>
              <tal:block replace="nothing">
                ___ element widget column ___
              </tal:block>
              <td tal:content="renderer_name">
                  
              </td>
            </tr>
          </tal:block>
        </tal:block>
      </tbody>
      <tfoot>
        <tr class="controls">
          <td class="align-right"
            colspan="2">
            <tal:block condition="not: is_ghosty">
              <span tal:replace="nothing"> _______ make changes after revoking approval _______ </span>
              <tal:block 
                condition="
                  python: is_versioned and model.get_approved_version() and display_flag == 1"
                >
                <form action="properties_revoke_approval"
                  method="POST">
                  <input 
                    class="button" 
                    type="submit" 
                    value="revoke approval" 
                    title="first 'un-approve' this item in order to edit: alt-r" 
                    accesskey="r"
                    i18n:attributes="value;title;accesskey revoke_approval_accesskey"
                  />
                </form>
              </tal:block>
              <span tal:replace="nothing"> _______ make changes in a new version _______ </span>
              <tal:block 
                condition="
                  python: is_versioned and not model.get_next_version()"
                >
                <form action="tab_edit_make_copy" method="POST">
                  <input type="hidden"
                    name="came_from_view"
                    tal:attributes="value template/id"
                  />
                  <input class="button"
                    type="submit"
                    value="new version"
                    title="create a new version of this content: alt-n"
                    accesskey="n"
                    i18n:attributes="value;title;accesskey new_version_accesskey"
                  />
                </form>
              </tal:block>
            </tal:block>
          </td>
        </tr>
      </tfoot>
    </table>
  </tal:block>
</tal:block>
</metal:block>
</html>
