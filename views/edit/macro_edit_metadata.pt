<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html tal:omit-tag=""
  lang="en"
  xml:lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:notal="http://www.infrae.com/silva/notal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  i18n:domain="silva">

<metal:block define-macro="metadata">
<tal:block define="
  ct python: mangle.String.centeredTruncate;
  truncatable python:['location'];
  ">
  <form method="post"
    action="."
    name="form"
    tal:define="
      metadata_category category | string:;
      binding python: view.get_metadata(content, category=metadata_category) or nothing;
      setnames binding/setNames | nothing;
      is_container request/model/implements_container | nothing;
      form_errors options/form_errors | nothing;"
    tal:condition="python: content and setnames"
    >
    <input type="hidden" name="returntotab" tal:attributes="value template/id"/>
    <table class="listing"
      tal:condition="binding"
      tal:attributes="style python:test(is_container, nothing, 'margin-bottom:2em')">
      <thead>
        <tr tal:replace="nothing">
          ______________ vein + title row ______________
        </tr>
        <tr>
          <td class="top" colspan="4">
            <h2 metal:define-slot="table_title">
              <img tal:replace="structure python:view.render_icon(model)" />
              <tal:block i18n:translate="">properties</tal:block>
              <tal:block condition="model/implements_container"
                i18n:translate="">
                  of &#xab;<tal:block content="string:${title}"
                    i18n:name="title">title</tal:block>&#xbb;
              </tal:block>
              <tal:block condition="not: model/implements_container"
                i18n:translate="">
                  of &#xab;<tal:block content="string:${title}"
                  i18n:name="title">
                  title</tal:block>&#xbb;
              </tal:block>
            </h2>
          </td>
        </tr>
      </thead>
      <tbody>
        <tal:block repeat="set_name setnames">
          <tal:block define="set_errors form_errors/?set_name | nothing">
            <tr tal:condition="not:repeat/set_name/start">
              <td class="divider"
                colspan="4"
                tal:attributes="style python:model.implements_container() and 'background:#c4d6e7' or 'background:#c5d4ca'">
              </td>
            </tr>
            <tr tal:replace="nothing">
              ______________ top controls row ______________
            </tr>
            <tr class="top-controls">
              <td colspan="4">
                <h3 tal:define="
                  set binding/?set_name/setTitle | set_name;
                  label python:set == 'silva-extra' and 'silva-meta' or set;
                  ">
                    <span i18n:translate="">metadata set</span> &#xab;<tal:block replace="label" />&#xbb;
                </h3>
              </td>
            </tr>
            <tr>
              <th class="align-right"
                width="12%"
                i18n:translate="">
                element
              </th>
              <th i18n:translate="">
                content
              </th>
              <th i18n:translate="">
                acquired content
              </th>
              <th width="25%"
                i18n:translate="">
                note
              </th>
            </tr>
            <tal:block repeat="element_name binding/?set_name/elementNames">
              <tal:block
                define="
                  element binding/?set_name/?element_name;
                  element_error form_errors/?set_name/?element_name | nothing;
                  iterate repeat/element_name/odd;"
                >
                <tal:block
                  condition="element/hidden"
                  replace="structure element/render"
                />
                <tr
                  tal:condition="not: element/hidden"
                  tal:attributes="
                    class python:element_error and 'alert' or iterate and 'odd' or 'even';"
                  >
                  <tal:block replace="nothing">
                    ___ element name column ___
                  </tal:block>
                  <td class="align-right">
                    <label
                      tal:content="element/title"
                      tal:attributes="for element_name"
                      tal:omit-tag="not:element/isEditable"
                      i18n:translate="">
                      Element name
                    </label>
                    <span class="warning"
                      tal:condition="element/isRequired">
                      *
                    </span>
                  </td>
                  <tal:block replace="nothing">
                    ___ element widget column ___
                  </tal:block>
                  <td tal:define="
                    data python: element['render'] or element['view'];
                    data python: element_name in truncatable and ct(data, 50) or data;
                    "
                    tal:condition="
                      python: element['isEditable'] or not element['isAcquired']"
                    tal:content="
                      structure data">
                    element edit widget
                  </td>
                  <tal:block replace="nothing">
                    ___ element acquired value column ___
                  </tal:block>
                  <td>
                    <tal:block
                      define="
                        data element/view;
                        data python: element_name in truncatable and ct(data, 50) or data;"
                      condition="element/isAcquired"
                      replace="structure data" />
                    <sup tal:condition="element/isAcquireable" i18n:translate="">
                      &#8224;
                    </sup>
                    <tal:block condition="not: element/isAcquired">
                      &nbsp;
                    </tal:block>
                  </td>
                  <tal:block replace="nothing">
                    ___ element desc. column ___
                  </tal:block>
                  <td>
                    <tal:block content="structure element/description" i18n:translate="">
                      Element description
                    </tal:block>
                    <span class="error"
                      tal:condition="element_error"
                      i18n:translate=""
                      tal:content="element_error">
                    </span>
                  </td>
                </tr>
              </tal:block>
            </tal:block>
          </tal:block>
          <tr tal:condition="python: set_name == 'silva-extra'">
            <th class="align-right">
            </th>
            <th i18n:translate="">
              date format: day / month / year &nbsp;23:59
            </th>
            <th i18n:translate="">
              &#8224; acquireable
            </th>
            <th>
            </th>
          </tr>
          <tr class="controls">
            <td class="align-right" colspan="4">
              <input class="button"
                type="submit"
                name="save_metadata:method"
                value="save"
                title="access key: alt-s"
                accesskey="s"
                i18n:attributes="value;title"
              />
            </td>
          </tr>
        </tal:block>
      </tbody>
    </table>
  </form>
</tal:block>
</metal:block>
</html>
