<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html tal:omit-tag=""
  lang="en"
  xml:lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:notal="http://www.infrae.com/silva/notal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  tal:define="
    vein string:subscriptions;
    global active_tab string:tab_metadata;
    global parent_screen_name string:properties;"
  i18n:domain="silva">

<metal:block use-macro="here/macro_index/macros/master">

<metal:block metal:fill-slot="middleground">
  <metal:block use-macro="here/macro_middleground/macros/properties" />
</metal:block>

<metal:block fill-slot="main">
<table class="columns columns3"
  tal:define="
    model request/model;
    type  model/meta_type;
    path  model/getPhysicalPath;
    url   model/absolute_url;
    title python: model.get_title_editable() or model.id;
  ">
  <tbody>
    <tr>
      <tal:block replace="nothing">
        _____________________ sidebar _____________________
      </tal:block>
      <td class="left"
        tal:define="template_id string:tab_subscriptions">
        <metal:use-macro use-macro="view/macro_vein_navigation/macros/vein">
          <metal:fill-slot fill-slot="sidebar">
            <tal:block replace="structure python: view.service_sidebar.render(model, 'tab_subscriptions', vein)" />
          </metal:fill-slot>
        </metal:use-macro>
      </td>
      <tal:block replace="nothing">
        _____________________ main _____________________
      </tal:block>
      <td class="main"
        tal:condition="may_approve_content">
        <tal:block define="
          dummy context/get_subscribable;
          subscribable request/subscribable;
          ">
          <tal:block condition="subscribable">
            <form method="post" name="form" action="." enctype="multipart/form-data"
              tal:define="form context/tab_subscriptions_form">
              <table class="listing">
                <thead>
                  <tr tal:replace="nothing">
                    ______________ icon + vein + title row ______________
                  </tr>
                  <tr>
                    <td class="top"
                      colspan="2">
                      <h2 i18n:translate="">
                        <img tal:replace="structure icon" i18n:name="icon"/>
                        manage subscriptions for
                        &#xab;<tal:block content="title" i18n:name="title" />&#xbb;
                      </h2>
                    </td>
                  </tr>
                </thead>
                <tbody tal:define="fields form/get_fields">
                  <tr>
                    <th width="33%"
                      i18n:translate="">
                      element
                    </th>
                    <th i18n:translate="">
                      content
                    </th>
                  </tr>
                  <tal:repeat repeat="field fields">
                    <tal:define define="iterate repeat/field/odd">
                      <tr tal:attributes="class python:iterate and 'odd' or 'even'">
                        <td class="designator"
                          style="width:33%">
                          <label tal:content="field/title"
                            tal:attributes="for field/id"
                            i18n:translate="">
                            title
                          </label><span class="warning"
                            tal:condition="field/is_required">*</span>
                          <p tal:content="structure python:field.get_value('description')">
                            comments here (field description)
                          </p>
                        </td>
                        <td class="field">
                          <input tal:replace="structure field/render" />
                        </td>
                      </tr>
                    </tal:define>
                  </tal:repeat>
                </tbody>
                <tfoot>
                  <tr>
                    <th i18n:translate=""
                      colspan="2">
                      * required
                    </th>
                  </tr>
                  <tr class="controls">
                    <td class="align-right"
                      colspan="2">
                      <input class="button"
                        type="submit"
                        name="tab_subscriptions_submit:method"
                        value="save subscription settings"
                        title="access key: alt-s"
                        accesskey="s"
                        i18n:attributes="title;value"
                      />
                    </td>
                  </tr>
                </tfoot>
              </table>
            </form>
          </tal:block>
          <tal:block
            condition="not:subscribable"
            i18n:translate="">
            This object is not subscribable content.
          </tal:block>
        </tal:block>
      </td>
      <td class="main"
        tal:condition="not:may_approve_content">
        If you see this message you have an author or reader role and there is
        nothing you can do in this screen. How did you get here?
      </td>
      <tal:block replace="nothing">
        _____________________ right column _____________________
      </tal:block>
      <td class="right">
      <tal:if condition="may_approve_content">
        <div class="info"
          tal:define="
            dummy context/get_subscribable;
            subscribable request/subscribable;
            is_subscribable subscribable/isSubscribable;
          ">
          <h3>
            <img class="icon"
              style="margin-top:-1px;"
              width="13"
              height="9"
              alt="subscriptions icon"
              tal:attributes="src string:${root_url}/globals/subscribe.gif"
              i18n:attributes="alt"
            />
            <span i18n:translate="">Subscriptions info</span>
          </h3>
          <p>
            <span class="subhead" i18n:translate="">
              Subscribing
            </span><br />
            <tal:block i18n:translate=""
              tal:condition="not: is_subscribable">
              This object can not be subscribed to.
            </tal:block>
            <tal:block i18n:translate=""
              tal:condition="is_subscribable">
              This object can be subscribed to.
            </tal:block>
          </p>
          <p tal:define="
            localsubscriptions request/subscriptions;
            allsubscriptions subscribable/getSubscriptions;
            numberofsubscriptions python: len(allsubscriptions) - len(localsubscriptions);
            "
            tal:condition="is_subscribable">
            <span class="subhead" i18n:translate="">
              Other subscriptions
            </span><br />
            <tal:block i18n:translate=""
              condition="numberofsubscriptions">
              <strong
                i18n:name="numberofsubscriptions"
                tal:content="numberofsubscriptions"
              />
              subscription(s) for this object defined above.
            </tal:block>
            <tal:block i18n:translate=""
              condition="not: numberofsubscriptions">
              No other subscriptions for this object.
            </tal:block>
          </p>
        </div>
      </tal:if>
      </td>
    </tr>
  </tbody>
</table>
</metal:block>

</metal:block>

</html>
