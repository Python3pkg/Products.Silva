<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html tal:omit-tag=""
  lang="en"
  xml:lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:notal="http://www.infrae.com/silva/notal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  tal:define="
    global vein string:status;
    " 
  i18n:domain="silva">
<metal:block use-macro="here/macro_index/macros/master">
<metal:block fill-slot="main"
  tal:define="
    view here;
    unapproved python:model.get_unapproved_version() is not None;
    request_pending python:unapproved and model.is_version_approval_requested();
    approved python:model.get_approved_version() is not None;
    published python:model.get_public_version() is not None;
    closed python:model.get_public_version_status() == 'closed';
    next python:model.get_next_version() is not None;
">

<table class="columns columns3">
  <tbody>
    <tr>
      <td class="left">
        <tal:block replace="nothing">
          _____________________ sidebar subtable _____________________
        </tal:block>
        <metal:block use-macro="view/macro_vein_navigation/macros/vein" />
      </td>
      <td class="main">
        <tal:block replace="nothing">
          _____________________ main subtable _____________________
        </tal:block>

<table class="listing">
<thead>
  <tr tal:replace="nothing"> ______________ vein + title row ______________ </tr>
  <tr>
    <td class="top" colspan="3">
    <h2 i18n:translate="access_status">
      <img tal:replace="structure python:view.render_icon(model)" />
      status of &#xab;<tal:block content="title" i18n:name="title"/>&#xbb;
    </h2>
    </td>
  </tr>

  <span tal:replace="nothing"> ______________ feedback from system ______________ </span>

  <span tal:replace="nothing"> _______ status: content is approved, not published _______ </span>
  <tr tal:condition="python:may_change_content and approved">
    <td class="feedback" colspan="3">
      <span class="subhead" style="color:ForestGreen;">Content is approved, not published</span><br />
      <span tal:condition="may_approve_content"
        tal:omit-tag="">Publication settings can be changed.</span>
        <metal:block use-macro="here/tab_status_macros/macros/datetime_info" />
    </td>
  </tr>

  <span tal:replace="nothing"> _______ status: content is published _______ </span>
  <tr tal:condition="python:may_change_content and not next and published">
    <td class="feedback" colspan="3">
      <span class="subhead" i18n:translate="published_content">Content is published</span><br />
      <tal:block i18n:translate="published_content_description">
      This content is published (online for the public).<br />
      If you wish you can make an editable copy by going to the <a href="tab_edit">editor</a>.
      </tal:block>
      <metal:block use-macro="here/tab_status_macros/macros/datetime_info" />
    </td>
  </tr>

  <span tal:replace="nothing"> _______ status: warning of new version of published content _______ </span>
  <tr tal:condition="python:may_change_content and unapproved and published">
    <td class="feedback" colspan="3">
      <span class="subhead" i18n:translate="existing_pub_version">Published version exists</span><br />
      <span class="warning" tal:condition="may_approve_content"
        i18n:translate="existing_pub_version_description">Note: an older version of this content is online.<br />
      Publishing this version will replace the public version.</span>
      <metal:block use-macro="here/tab_status_macros/macros/datetime_info" />
    </td>
  </tr>

  <span tal:replace="nothing"> _______ status: content is closed _______ </span>
  <tr tal:condition="python:may_change_content and not next and closed">
    <td class="feedback" colspan="3">
      <span class="subhead" i18n:translate="closed_content">Content is closed</span><br />
      <tal:block i18n:translate="closed_content_description">  
        This content was once published but is now closed.<br /> If you
        wish you can make an editable copy in the <a
          href="tab_edit">editor</a>.
      </tal:block>
     <metal:block use-macro="here/tab_status_macros/macros/datetime_info" />
    </td>
  </tr>
</thead>


<tbody>
<span tal:replace="nothing"> _______ messages _______ </span>
<div metal:use-macro="view/tab_status_macros/macros/messages">
messages
</div>

<span tal:replace="nothing"> _______ Author requests approval _______ </span>
<check tal:condition="python:not may_approve_content and unapproved and not request_pending"
  tal:omit-tag="">
<div metal:use-macro="view/tab_status_macros/macros/request_approval">
request approval section here
</div>
</check>

<span tal:replace="nothing"> _______ approved, Editor can change settings _______ </span>
<check tal:condition="python:may_approve_content and approved"
  tal:omit-tag="">
<div metal:use-macro="view/tab_status_macros/macros/approved_editor">
change settings section here
</div>
</check>
</tbody>
</table>


<span tal:replace="nothing"> ______________ sub tables ______________ </span>

<span tal:replace="nothing"> _______ Editor considers approval _______ </span>
<check tal:condition="python:may_approve_content and (unapproved or closed) and not approved"
  tal:omit-tag="">
<metal:block use-macro="view/tab_status_macros/macros/approve_new">
approval section here
</metal:block>
</check>

<span tal:replace="nothing"> _______ Author/Editor withdraws/rejects request for approval _______ </span>
<check tal:condition="python:may_change_content and unapproved and request_pending"
  tal:omit-tag="">
<div metal:use-macro="view/tab_status_macros/macros/withdraw_request_approval">
request approval section here
</div>
</check>

<span tal:replace="nothing"> _______ revoke approval _______ </span>
<check tal:condition="python:may_change_content and approved"
  tal:omit-tag="">
<div metal:use-macro="view/tab_status_macros/macros/revoke_approval">
revoke approval section here
</div>
</check>


<span tal:replace="nothing"> _______ revert to previous _______ </span>
<check tal:condition="python:may_change_content and (published or closed) and unapproved"
  tal:omit-tag="">
<div metal:use-macro="view/tab_status_macros/macros/revert_to_previous">
_______ revert to previous section here _______
</div>
</check>


<span tal:replace="nothing"> _______ manual close _______ </span>
<check tal:condition="python:may_approve_content and published"
  tal:omit-tag="">
<div metal:use-macro="view/tab_status_macros/macros/manual_close">
_______ manual close section here _______
</div>
</check>


<span tal:replace="nothing"> _____________________ export table _____________________ </span>
 <form action="." enctype="multipart/form-data" method="POST" tal:condition="python: model.meta_type == 'Silva Document'">
   <input type="hidden" 
     name="refs:list"
     tal:attributes="value python: request['model'].create_ref(request['model'])" />
   <table class="listing sublisting">
     <thead>
       <tr tal:replace="nothing">
         ______________ vein + title row ______________
       </tr>
       <tr>
         <td class="top">
           <h2 tal:attributes="title string:id: ${model/id}">
             <img tal:replace="structure python:view.render_icon(model)" />
             <tal:block i18n:translate="export_document">
             export &#xab;
             <tal:block content="string:${model/get_title_editable}"
              i18n:name="export_id">id</tal:block>&#xbb;
             </tal:block>
           </h2>
         </td>
       </tr>
     </thead>

     <tbody>
       <tr class="even">
         <td>
           <span i18n:translate="access_export_description">
           Export this document via the export screen as Silva XML, or
           &#8211; if the <a
             href="http://www.infrae.com/products/docma">DocmaServer</a> is
           installed &#8211; convert it to a another format.</span><span
           tal:condition="python: not next and not closed"
           i18n:translate="access_export_noversion">There is no
             new version, so the published version will be exported.</span>
         </td>
       </tr>
     </tbody>

     <tfoot>
       <tr class="controls">
         <td class="align-right">
           <input class="transport"
             type="submit"
             tal:attributes="name python: '%s/edit/tab_status_export:method' % '/'.join(request['model'].get_container().getPhysicalPath())"
             value="export..."
             title="access key: alt-e"
             accesskey="e"
             i18n:attributes="value title"
           />
         </td>
       </tr>
     </tfoot>
   </table>
 </form>


<tal:replace replace="nothing">
<span tal:replace="nothing"> _______ status: content is approved, not published _______ </span>
<div class="feedback" tal:condition="python:may_change_content and approved">
<span class="subhead">Content is approved, not published</span><br />
<span tal:condition="not:may_approve_content"
  tal:omit-tag="">Publication settings can be changed.<br /></span>
<metal:block use-macro="here/tab_status_macros/macros/datetime_info" />
</div>

<span tal:replace="nothing"> _______ status: content is published _______ </span>
<div class="feedback" tal:condition="python:may_change_content and not next and published">
  <span class="subhead" 
    i18n:translate="published_content">Content is published
  </span>
  <br />
  <tal:block i18n:translate="published_content_description">
  This content is published (online for the public).<br /> If you wish you
  can make an editable copy by going to the <a href="tab_edit">editor</a>.
  </tal:block>
<metal:block use-macro="here/tab_status_macros/macros/datetime_info" />
</div>

<span tal:replace="nothing"> _______ status: warning of new version of published content _______ </span>
<div class="feedback" tal:condition="python:may_change_content and unapproved and published">
  <span class="subhead" i18n:translate="existing_pub_version">Published version exists</span><br />
  <tal:block i18n:translate="existing_pub_version_description">
    Note: <span class="warning">an older version of this content is
    online.</span><br /> Publishing this version will replace the public
    version.
  </tal:block>
<metal:block use-macro="here/tab_status_macros/macros/datetime_info" />
</div>

<span tal:replace="nothing"> _______ status: content is closed _______ </span>
<div class="feedback" tal:condition="python:may_change_content and not next and closed">
<span class="subhead" i18n:translate="closed_content">Content is closed</span><br />
<tal:block i18n:translate="closed_content_description">
  This content was once published but is now closed.<br /> If you wish you
  can make an editable copy by going to the <a href="tab_edit"><span
      class="index-link">Edit tab</span></a>.
</tal:block>
<metal:block use-macro="here/tab_status_macros/macros/datetime_info" />
</div>
</tal:replace>

      </td>
      <tal:block replace="nothing">
        _____________________ right column _____________________ 
      </tal:block>
      <td class="right">        
        &nbsp;
      </td>
    </tr>
  </tbody>
</table>

</metal:block>
</metal:block>
</html>
