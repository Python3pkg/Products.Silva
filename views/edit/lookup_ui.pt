<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html tal:omit-tag=""
  lang="en"
  xml:lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:notal="http://www.infrae.com/silva/notal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  tal:define="
    global active_tab string:tab_access;
    global breadcrumb_vein string:Lookup;
  ">
<metal:block use-macro="here/macro_index/macros/master">
<metal:block fill-slot="main">

<script type="text/javascript" 
  tal:content="structure python:here.focus_editor('name')">
  focus cursor
</script>

<h3>
  <a href="lookup_back_link"
    title="Up to top of Access tab"
    tal:attributes="href here/lookup_back_link">
    <img alt="Up to top of Access tab"
      border="0"
      height="16"
      width="16"
      tal:attributes="src string:${root_url}/globals/left.gif" />
    Back
  </a>
</h3>

<table class="columns columns3">
  <tbody>
    <tr>
      <td class="left">
      </td>
      <td class="main">
        <span tal:replace="nothing">
          _____________________ inner table  _____________________
        </span>
        <table class="listing"
          width="100%">

          <thead>
            <tr tal:replace="nothing">
              ______________ vein + title row ______________
            </tr>
            <tr>
              <td class="top"
                colspan="3">
                <h2 tal:attributes="title string:id: ${model/id}">
                  <img tal:replace="structure python:view.render_icon(model)" />
                  Users lookup at:                
                  &#xab;<span tal:replace="structure string:${model/get_title_html}">title</span>&#xbb;
                </h2>
              </td>
            </tr>
          </thead>

          <form action="lookup_search"
            method="POST">
            <tr class="topcontrols">
              <th align="left">
                <span class="tablehead4">
                  User search
                </span>
              </th>
            </tr>
            <tr class="focus">
              <td class="rowhead">
                Name (or part of name):
                <br />
                <input class="textarea"
                  name="name"
                  style="width:100%;"
                  type="text"
                  value="" />
              </td>
            </tr>
            <tr class="controls">
              <td align="right">
                <input class="button"
                  accesskey="s"                      
                  title="Search - alt-s"
                  type="submit"
                  value="Search" />
              </td>
            </tr>
            <tr>
              <td align="left">
                &nbsp;
              </td>
            </tr>
          </form>
              <!-- __________________________ search results ______________________________ -->
          <form action="lookup_add_to_selection" method="POST">
            <tr class="topcontrols">
              <th align="left">
                <span class="tablehead4">
                  Search results
                </span>
              </th>
            </tr>
            <tal:block define="global lookup_result options/results | nothing" />
            <!-- If many items in result; put a second button on top as well. 
            Is this UI-wise "done" or "not done"? -->
            <tr class="topcontrols"
              tal:condition="python:lookup_result and len(lookup_result) > 3">
              <td align="right">
                <img height="18px"
                  src="pixel.gif"
                  width="1px"
                  tal:attributes="src string:${root_url}/globals/pixel.gif" />
                <input class="button"
                  accesskey="a"                      
                  title="Add checked users to your selection list on the right - ctrl-a"
                  type="submit"
                  value="Add to selection" />
              </td>
            </tr>
            <!-- Listing loop -->
            <tal:block repeat="member lookup_result">
              <tr class="focus"
                tal:define="iterate repeat/member/odd"
                tal:attributes="class python:iterate and 'odd' or 'even';">
                <td align="left"
                  valign="top"
                  width="1%">
                  <input name="userids:list"
                    type="checkbox"
                    value=""
                    tal:attributes="value member/userid" />
                  <span class="subhead"
                    tal:content="member/fullname" />
                  &nbsp;
                  <span class="subhead">
                    email:
                  </span>
                  <span tal:replace="member/email | no_entry" />
                  <br />
                </td>
              </tr>
            </tal:block>
            <tr class="focus"
              tal:condition="python:not lookup_result">
              <td align="left"
                colspan="2"
                valign="top">
                <i>
                  (no search results)
                </i>
              </td>
            </tr>
            <tr class="controls">
              <td align="right"
                colspan="2">
                <input class="button"
                  accesskey="a"                      
                  title="Add checked users to your selection list on the right - ctrl-a"
                  type="submit"
                  value="Add to selection"
                  tal:condition="lookup_result" />
              </td>
            </tr>
          </form>
        </table>
      </td>
      <td class="right">
        <!-- Clipboard -->
        <metal:block use-macro="view/macro_user_lookup_clipboard/macros/clipboard">
          <metal:block fill-slot="clipboard_lookup_action">
            <a class="navigation" 
              style="float: right;"
              accesskey="u"
              title="Return to the top of the access tab with this clipboard - ctrl-u"
              href="lookup_back_link"
              tal:attributes="href here/lookup_back_link">
              Use current clipboard...
            </a>
          </metal:block>
          <metal:block fill-slot="clipboard_actions">
            <input class="warning"
              accesskey="d"
              name="lookup_remove_from_selection:method"
              title="Remove users from your clipboard: alt-d"
              type="submit"
              value="Remove from clipboard" />
          </metal:block>
        </metal:block>
      </td>
    </tr>
  </tbody>
</table>

<div class="worksheet borders top bottom left right"
  tal:define="global no_entry string:-"
  tal:condition="python:view.has_access()">
</div>

</metal:block>
</metal:block>
</html>
