<html tal:omit-tag=""
  tal:define="
    view here;
    model request/model;
    root_url model/get_root_url;
    title model/get_title_editable;
    breadcrumb_vein string:Editor;
    ">

<metal:use-macro use-macro="view/macro_asset_edit/macros/editor">
<metal:fill-slot fill-slot="info">
  <div class="info"
    tal:condition="model/canScale">
    <h3 class="info">
      <img tal:replace="structure icon" /> Image info
    </h3>
    <p tal:condition="not: model/hires_image">
      <span class="subhead">format</span><br />
      <span tal:replace="model/getFormat" /> image<br />
      <span class="subhead">dimensions</span><br />
      <span 
        tal:define="
          img_width python: model.getDimensions()[0];
          img_height python: model.getDimensions()[1];
          "
        tal:on-error="string: unknown"
        tal:replace="string:${img_width}x${img_height}"
      />
    </p> 
    <p tal:condition="model/hires_image">
      <span class="subhead">format</span><br />
      <span tal:replace="model/web_format">format</span> image
    </p>
    <p>
      <span class="subhead">dimensions</span><br />
      <span tal:define="
        img_width python: model.getDimensions()[0];
        img_height python: model.getDimensions()[1];
        "
        tal:on-error="string: unknown"
        tal:replace="string:${img_width}x${img_height}"
        />, scaled to 
        <span tal:define="
          img_width python: model.getCanonicalWebScale()[0];
          img_height python: model.getCanonicalWebScale()[1];
          "
          tal:on-error="string: unknown"
          tal:replace="string:${img_width}x${img_height}"
        />
    </p>
    <p>
      <span class="subhead">original</span><br />
      <a href="" class="underline"
        title="see the original image"
        accesskey="v"
        tal:attributes="href string:${model/absolute_url}/hires_image">
          view unscaled image
      </a>
    </p>
    <p tal:define="path model/getFileSystemPath"
      tal:condition="path">
      <span class="subhead"><b>file system path</b><br /></span>
      <span tal:replace="structure python:  ' / '.join(path.split('/'))" />
    </p>
  </div>
  <div class="info"
    tal:condition="not: model/canScale">
    Note: Silva can provide image scaling and conversion with the help of PIL 
    (<a href="http://www.pythonware.com/products/pil/">Python Imaging Library</a>).
    PIL doesn't seem to be installed.
  </div>
</metal:fill-slot>

<metal:block use-macro="view/macro_asset_edit/macros/uploader" />
<metal:fill-slot fill-slot="additional_tools">
  <form method="POST" name="form" action="." enctype="multipart/form-data"
    tal:condition="model/canScale">
    <table class="listing">
      <thead>
        <tal:block replace="nothing">
          ______________ top controls row ______________
        </tal:block>
        <tr class="top-controls">
          <td colspan="3">
            <h3>
              Format and Scaling
            </h3>
          </td>
        </tr>
      </thead>
      <tbody tal:define="fields view/scale_form/get_fields">
        <tr>
          <th class="align-right"
            width="12%">
            Element
          </th>
          <th>
            Content
          </th>
          <th width="40%">
            Note
          </th>
        </tr>
        <tal:repeat repeat="field fields">
          <tal:define define="iterate repeat/field/odd">
            <tr tal:attributes="class python:iterate and 'even' or 'odd'">
              <td class="field-title">
                <span tal:replace="python:field['title']">
                  Title</span><span class="warning"
                  tal:condition="python:field.is_required()">*</span>
              </td>
              <td>
                <input tal:replace="structure python:field.render_from_request(request)" />
              </td>
              <td>
                <span tal:replace="structure python:field.get_value('description')">
                  comments here (field description)
                </span>
              </td>
            </tr>
          </tal:define>
        </tal:repeat>
      </tbody>
      <tfoot>
        <tr class="controls">
          <td class="align-right"
            colspan="3">
            <input class="button"
              type="submit"
              name="scale_submit:method"
              value="Set format and scale"
              title="access key: alt-s"
              accesskey="s"
            />
          </td>
        </tr>
      </tfoot>
    </table>
  </form>

  <metal:block use-macro="view/macro_asset_edit/macros/uploader" />
</metal:fill-slot>
</metal:use-macro>

</html>
