<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html tal:omit-tag=""
  lang="en"
  xml:lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:notal="http://www.infrae.com/silva/notal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  tal:define="global vein string:contents;"
  i18n:domain="silva">

  <metal:block use-macro="here/macro_no_tabs/macros/master">
    <metal:block fill-slot="extension_css">
  <style type="text/css">
    #draggable {
      background-color: white;
      position: absolute;
      z-index: 1;
      border: 1px dashed black;
      -moz-opacity: 0.5;
    }

    #dragbar table {
      border: 1px solid black;
    }
    
    #dragbar {
      background-color: #91989b;
      border: 1px solid black;
      color: white;
      text-align: center;
      cursor: move;
      z-index: 5;
      -moz-opacity: 1;
    }

    #dragbar:active {
      background-color: red;
    }

    #handle {
      cursor: se-resize;
      border-right: 2px solid black;
      border-bottom: 2px solid black;
      z-index: 5;
    }
    
    #handle:active {
      border-right: 2px solid red;
      border-bottom: 2px solid red;
    }
    
  </style>
    </metal:block>
    <metal:block fill-slot="main"
      tal:define="model python:request.model;">
      
      <script type="text/javascript"
          tal:attributes="src view/cropping.js/absolute_url">
      </script>
      <script type="text/javascript">
        //<!CDATA[[

          function setDraggableSize(width, height) {
            var draggable = document.getElementById('draggable');
            draggable.style.width = width + 'px';
            draggable.style.height = height + 'px'; // added the height of the dragbar
          };
        
        //]]>
      </script>
      <div style="position: absolute; top: 0px; left: 0px;">
        <ul style="position: absolute;">
          <li>
            <a href="#"
              onclick="setDraggableSize(75, 75)"
              title="Resize to 75x75 pixels">
              set window to 75x75 Pixel
            </a>
          </li>
          <li>
            <a href="#" 
              onclick="setDraggableSize(100, 100)" 
              title="Resize to 100x100 pixels">
              set window to 100x100
            </a>
          </li>
          <li>
            <a href="#" 
              onclick="setDraggableSize(250, 250)" 
              title="Resize to 250x250 pixels">
              set to 250x250
            </a>
          </li>
          <li>
            <input 
            type="button" 
            onclick="opener.insertCropCoords(cropper.width(),
            cropper.height(), cropper.left(), cropper.top(), self)"
            value="set coordinates"
            />
          </li>
        </ul>
      <div id="draggable" 
        style="position: absolute; 
          min-width: 25px;
          width: 150px; 
          min-height: 25px; 
          height: 100px;
          top: 10px; 
          left: 10px">
          <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
            <thead>
            <tr>
              <th colspan="2" id="dragbar" 
                style="height: 20px; line-height: 20px;" 
                onclick="this.blur()">
                Drag
              </th>
          </tr>
            <tr><td colspan="2" id="additional_draggable">&nbsp;</td></tr>
        </thead>
        <tbody>
          <tr>
              <td colspan="2" height="100%" valign="top">
                &nbsp;
              </td>
            </tr>
            <tr>
              <td>&nbsp;</td>
              <td width="14" height="14" style="line-height: 10px; padding: 0px">
                <div id="handle" style="width: 10px; height: 10px;">&nbsp;</div></td>
            </tr>
          </tbody>
          </table>
        </div>
        
        <img id="image" tal:attributes="src string:${model/absolute_url}/hires_image;
        alt model/title_or_id" /> 
      </div>

      <script type="text/javascript">
        //<!CDATA[[
        
          cropper = new Cropper('draggable', 
                                  'dragbar', 
                                  'handle', 
                                  50, 
                                  10);

        //]]>
      </script>
      
  </metal:block>
</metal:block>
</html>
