<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html tal:omit-tag=""
  lang="en"
  xml:lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:notal="http://www.infrae.com/silva/notal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  tal:define="global vein string:contents;"
  i18n:domain="silva">
  
  <metal:block use-macro="here/macro_no_tabs/macros/master">
    <metal:block fill-slot="extension_css">
      <style type="text/css">
        body {
        background: #91989b;
        }
        #draggable {
        background-color: transparent;
        position: absolute;
        z-index: 1;
        border: 1px dashed #73868c;
        /*-moz-opacity: 0.50;*/
        }
        
        #dragbar, #additional_draggable {
        color: #73868c;
        text-align: center;
        cursor: move;
        }
        
        /* IE
        #additional_draggable {
        background-color: white;
        FILTER:Alpha(Opacity=50, FinishOpacity=30, Style=0);
        } */
        /* mozilla 
        table {
        background-color: transparent;
        }
        
        table:active {
        background-color: white;
        -moz-opacity: 0.5;
        }
        */
        
        table{
        background-color: white;
        -moz-opacity: 0.5;
        FILTER:Alpha(Opacity=50, FinishOpacity=30, Style=0);
        }
        
        #handle {
        cursor: se-resize;
        border-right: 3px solid #73868c;
        border-bottom: 3px solid #73868c;
        margin: 0; 
        padding: 0;
        }
        
        #handle:active {
        border-right: 3px solid red;
        border-bottom: 3px solid red;
        }
        
        ul {
        list-style: none;
        padding-left: 15px;
        }
        
        a.button, a, a:link, a:visited {
        display: block;
        font-size: 95%; 
        color: #def3de;
        background-color: #004d29;
        border: 1px solid #6bb694;
        padding: 0.2em 0.5em;
        margin: 0.7em 0;
        width: 10em;
        text-align: center;
        text-decoration: none;
        }
        a.button:hover {
        color: #e6ffef;
        background-color: #528e73;
        border: 1px solid #8cc2ad;
        text-decoration: none;
        }
        
        #ground {
        position: absolute;
        top: 350px;
        left: 0px;
        width: 180px;
        height: 130px;
        }


      </style>
    </metal:block>
    <metal:block fill-slot="main"
      tal:define="model python:request.model;">
      <div class="workspace">
        
        <script type="text/javascript"
          tal:attributes="src view/cropping.js/absolute_url">
        </script>
        <script type="text/javascript">
          //<![CDATA[

          function setDraggableSize(width, height) {
            var draggable = document.getElementById('draggable');
            draggable.style.width = width + 'px';
            draggable.style.height = height + 'px'; // added the height of the dragbar
          };
        
        //]]>
        </script>
        <div class="info" style='width: 180px; top: 0px; left: 0px; position: absolute; '>
          <h3>predefined sizes:</h3>
          <ul style="list-item-style: none">
            <li>
              <a href="#" class="button" 
              onclick="setDraggableSize(50, 50)"
              title="50x50 pixels">
                50x50 Pixel
              </a>
            </li>
            <li>
              <a href="#" class="button"
              onclick="setDraggableSize(75, 75)"
              title="75x75 pixels">
                75x75 Pixel
              </a>
            </li>
            <li>
              <a href="#" class="button"
              onclick="setDraggableSize(100, 100)" 
              title="100x100 pixels">
                100x100 Pixel
              </a>
            </li>
            <li>
              <a href="#" class="button"
              onclick="setDraggableSize(250, 250)" 
              title="250x250 pixels">
                250x250 Pixel
              </a>
            </li>
          </ul>
          
          <h3>information</h3>
          <p>
            Drag the window below to the image region which should be cropped.
            You can resize the window with the handle on the lower right
            corner. If you're done, you can use the submit button below or a
            double click in the window to submit your coordinates and close the
            window.
          </p>
          
          <input class="transport" 
              type="button" 
              onclick="cropper.insertCropCoords()"
              value="use coordinates..."
              title="alt-u"
              accesskey="u"
              style="float: right"
            />
        </div>
        <div style="top: 0px; margin-left: 200px;">
          <div class="info" id="ground">
            <h3>Dragwindow</h3>
          </div>
          <div id="draggable" 
        style="position: absolute; 
          min-width: 25px;
          width: 150px; 
          min-height: 25px; 
          height: 100px;
          top: 370px;
          left: 30px">
            <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
              <thead>
                <tr>
                  <th id="dragbar" 
                  style="height: 20px;position:
                  absolute;"
                  colspan="2"
                  onclick="this.blur()">
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr height="100%">
                  <td colspan="2" id="additional_draggable">&nbsp;
                  </td>
                </tr>
                <tr>
                  <td> &nbsp; </td>
                  <td width="14" height="14" style="padding: 0px;">
                    <div id="handle" style="width: 10px; height: 10px;">&nbsp;</div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <img id="image"  
          tal:attributes="src string:${model/absolute_url}/hires_image;
                          alt model/title_or_id"
        /> 
        </div>
        
        <script type="text/javascript">
          //<![CDATA[
        
          cropper = new Cropper('draggable', 
                                  'dragbar', 
                                  'handle', 
                                  25, 
                                  25);

        //]]>
        </script>
      </div>
       
    </metal:block>
  </metal:block>
</html>
