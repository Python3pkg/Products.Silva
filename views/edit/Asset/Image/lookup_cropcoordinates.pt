<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html tal:omit-tag=""
  lang="en"
  xml:lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:notal="http://www.infrae.com/silva/notal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  tal:define="global vein string:contents;"
  i18n:domain="silva">

  <metal:block use-macro="here/macro_no_tabs/macros/master">
    <metal:block fill-slot="extension_css">
      <style type="text/css">

        #draggable {
          position: absolute;
          border: 1px dotted black;
          z-index: 1;
          -moz-opacity: 0.6;
        }

        #dragbar {
          background-color: #91989b;
          border: 1px solid black;
          color: white;
          text-align: center;
          cursor: default;
          z-index: 5;
          -moz-opacity: 1;
        }

        #dragbar:active {
          background-color: red;
        }

        #handle {
          cursor: se-resize;
          border-right: 2px solid black;
          border-bottom: 2px solid black;
        }
        
        #handle:active {
          border-right: 2px solid red;
          border-bottom: 2px solid red;
        }
        
      </style>
    </metal:block>
    <metal:block fill-slot="main"
      tal:define="model python:request.model;">
      
      <script type="text/javascript"
          tal:attributes="src view/cropping.js/absolute_url">
      </script>
      <script type="text/javascript">
        //<!CDATA[[

          function setDraggableSize(width, height) {
            var draggable = document.getElementById('draggable');
            draggable.style.width = width + 'px';
            draggable.style.height = height + 'px'; // added the height of the dragbar
          };
        
        //]]>
      </script>
      <div style="position: absolute; top: 0px; left: 0px;">
        <div id="draggable" style="position: absolute; width: 150px; height: 100px; top: 10px; left: 10px">
          <table class="foobar" width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
            <tbody>
            <tr><td colspan="2" valign="top"><div id="dragbar" style="height: 20px;">Drag the window</div></td></tr>
            <tr><td colspan="2" id="additional_draggable">&nbsp;</td></tr>
            <tr>
              <td width="100%">&nbsp;</td>
              <td height="1%" valign="bottom"><div style="width: 10px; height: 10px;" id="handle">&nbsp;</div></td>
            </tr>
            </tbody>
          </table>
        </div>
        
        <img id="image" tal:attributes="src string:${model/absolute_url}/hires_image;
        alt model/title_or_id" /> 
        <!-- 
        onclick="getCoordinates()" id="image" style="cursor: crosshair"/>-->
        
      </div>

      <script type="text/javascript">
        //<!CDATA[[
        
          cropper = new Cropper('draggable', 
                                  'dragbar', 
                                  'handle', 
                                  50, 
                                  10);

        //]]>
      </script>
      
  </metal:block>
</metal:block>
</html>
