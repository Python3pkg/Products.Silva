lookupWindow = null;

function getCoordinates(event) {
  // check if we shoul go for netscape or ms syntax
  var name = navigator.appName;

  if (name == "Microsoft Internet Explorer") {
  x = window.event.offsetX;
  y = window.event.offsetY;
  opener.insertCropCoords(x, y, self);
  }
  else if (name == "Netscape") {
  document.getElementById("image").addEventListener("click", setCoords, true);
  }
}


function setCoords(ev) {
  x = ev.layerX;
  y = ev.layerY; 
  opener.insertCropCoords(x, y, self);
}

function openlookupWindow(url_to_open, url_to_image) {
width = 512;
  height = 512;
  leftPos = (screen.width - width) / 2;
  topPos = (screen.height - height) / 2;
  aspects = 'toolbar=no, status=yes, scrollbars=yes, resizable=yes, width='+width+',height='+height+',left='+leftPos+',top='+topPos;
  lookupWindow = window.open(
    url_to_open, 'ImageMapWindow', aspects);
  lookupWindow.focus();
}

function insertCropCoords(x, y, wndw) {
  // Append to previously focused text area
  field_x = document.getElementById("x");
  field_y = document.getElementById("y");
  
  field_x.value = x;
  field_y.value = y;
  
  // Close LookupWindow
  wndw.close();
}
//  -->
