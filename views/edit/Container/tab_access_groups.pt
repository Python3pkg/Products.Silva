<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html tal:omit-tag=""
  lang="en"
  xml:lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:notal="http://www.infrae.com/silva/notal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  tal:define="
    global vein string:Groups;
    global active_tab string:tab_access;
    global parent_screen_name string:access;
    "
  i18n:domain="silva">

<metal:block use-macro="here/macro_index/macros/master">
<metal:block fill-slot="script">
  <script type="text/javascript"
    tal:content="structure python:here.focus_editor('field_object_id')" />
</metal:block>
<metal:block fill-slot="main"
  tal:define="
    allow_authentication_requests model/service_members/allow_authentication_requests | nothing;
    has_access here/has_change_access_permission;"
  tal:condition="has_access">

<table class="columns columns3">
  <tbody>
    <tr>
      <td class="left">
        <tal:block replace="nothing">
          ______________ vein navigation ______________
        </tal:block >
        <metal:use-macro use-macro="view/macro_vein_navigation/macros/vein">
          <metal:fill-slot fill-slot="sidebar">
            <tal:block replace="structure python: view.service_sidebar.render(model, 'tab_access_groups', vein)" />
          </metal:fill-slot>
        </metal:use-macro>
      </td>

      <tal:block replace="nothing">
        _____________________ main subtable _____________________
      </tal:block>
      <td class="main">

<tal:block replace="nothing">
  _____________________ add group _____________________
</tal:block>
<form
  method="post"
  action="add_object_submit"
  name="focusbox"
  enctype="multipart/form-data">
  <table class="listing">
    <thead>
      <tr tal:replace="nothing">
        ______________ vein + title row ______________
      </tr>
      <tr>
        <td class="top"
          colspan="2">
          <h2 tal:attributes="title string:id: ${model/id}">
            <img tal:replace="structure icon" />
            <tal:block i18n:translate="">
              groups in
              &#xab;<tal:block content="title" i18n:name="title"/>&#xbb;
            </tal:block>
          </h2>
        </td>
      </tr>
      <tr class="top-controls">
        <td colspan="3">
          <h3 i18n:translate="">
            create a group
          </h3>
        </td>
      </tr>
    </thead>
    <tbody>
      <tr class="even">
        <td class="designator"
          style="width:33%">
          <label for="field_object_id">id</label><span class="warning">*</span>
          <p i18n:translate="">
            No spaces or special characters besides &#8216;_&#8217; or &#8216;-&#8217; or &#8216;.&#8217;
          </p>
        </td>
        <td class="field">
          <input class="store"
            id="field_object_id"
            type="text"
            value=""
            name="field_object_id"
            size="20"
          />
        </td>
      </tr>
      <tr class="odd">
        <td class="designator"
          style="width:33%">
          <label for="field_object_id"
             i18n:translate="">type</label><span class="warning">*</span>
        </td>
        <td class="field">
          <select class="store"
            name="meta_type">
            <option value="Silva Group" i18n:translate="">
              Group: a group defined by a list of users
            </option>
            <option value="Silva Virtual Group"
            i18n:translate="">
              Virtual Group: a group defined by a list of normal groups
            </option>
            <option value="Silva IP Group" i18n:translate="">
              IP Group: a group based on ip addresses
            </option>
          </select>
        </td>
      </tr>
    </tbody>
    <tfoot>
      <tr class="controls">
        <td colspan="2">
          <input class="button"
            style="float:right"
            type="submit"
            name="add_edit_submit"
            value="save + edit"
            title="access key: alt-e"
            accesskey="e"
            i18n:attributes="title;value"
          />
          <input class="button"
            style="float:right"
            type="submit"
            name="add_submit"
            value="save"
            title="access key: alt-s"
            accesskey="s"
            i18n:attributes="title;value"
          />
        </td>
      </tr>
    </tfoot>
  </table>
</form>

<form id="group_assets"
  name="group_assets"
  action="tab_access_groups_delete"
  method="post"
  tal:define="groups view/get_locally_defined_groups">
  <table class="listing">
    <thead>
      <tr class="top-controls">
        <td colspan="5">
          <h3 i18n:translate="">
            groups located in this folder
          </h3>
        </td>
      </tr>
    </thead>

    <tbody>
      <tr tal:condition="groups">
        <th class="listing-left">
        </th>
        <th i18n:translate="">
          name
        </th>
        <th i18n:translate="">
          type
        </th>
        <th i18n:translate="">
          modified
        </th>
        <th i18n:translate="">
          modifier
        </th>
      </tr>
      <tal:repeat repeat="group groups">
        <tal:define define="iterate repeat/group/odd">
          <tr tal:attributes="class python:iterate and 'odd' or 'even'">
            <td nowrap="1">
              <input class="min"
                type="checkbox"
                name="groupids:list"
                tal:attributes="value group/id;
              " />
              <a class="icon"
                title="edit"
                tal:attributes="
                  href string:${group/absolute_url}/edit;
                  title group/meta_type">
                <img tal:replace="structure python:view.render_icon(group)" />
              </a>
            </td>
            <td>
              <a class="published"
                title="edit this group"
                tal:attributes="href string:${group/absolute_url}/edit"
                i18n:attributes="title">
                <tal:block replace="group/id">
                  id
                </tal:block>
              </a>
            </td>
            <td tal:replace="nothing">
              <a class="blacklink"
                title="edit this group"
                tal:attributes="href string:${group/absolute_url}/edit"
                i18n:attributes="title">
                <tal:block replace="group/get_title">
                  title
                </tal:block>
              </a>
            </td>
            <td tal:content="structure group/meta_type">
              type
            </td>
            <td>
              <tal:block replace="structure python:mangle.DateTime(group.get_modification_datetime()).toShortStr() or default">
                -
              </tal:block>
            </td>
            <td tal:content="python:group.sec_get_last_author_info().fullname()">
              author name
            </td>
          </tr>
        </tal:define>
      </tal:repeat>
      <tr class="even">
        <td colspan="5"
          tal:condition="not:groups">
          <i i18n:translate="">
            No groups have been defined in this location.
          </i>
        </td>
      </tr>
    </tbody>
    <tfoot>
      <tr class="controls">
        <td colspan="5">
          <input class="button remover"
            type="submit"
            value="delete"
            title="delete selected groups: alt-d"
            accesskey="d"
            alt="Really delete?"
            onclick="return confirm(this.alt)"
            tal:condition="groups"
            i18n:attributes="title;value;alt"
          />
        </td>
      </tr>
    </tfoot>
  </table>
</form>


  <table class="listing" tal:define="groups view/get_groups_defined_elsewhere">
    <thead>
      <tr class="top-controls">
        <td colspan="5">
          <h3 i18n:translate="">
            groups defined elsewhere
          </h3>
        </td>
      </tr>
    </thead>

    <tbody>
      <tr tal:condition="groups">
        <th class="listing-left">
        </th>
        <th i18n:translate="">
          name
        </th>
        <th i18n:translate="">
          type
        </th>
        <th i18n:translate="">
          modified
        </th>
        <th i18n:translate="">
          modifier
        </th>
      </tr>
      <tal:repeat repeat="group groups">
        <tal:define define="iterate repeat/group/odd">
          <tr tal:attributes="class python:iterate and 'odd' or 'even'">
            <td nowrap="1">
              <input class="min"
                type="checkbox"
                name="groupids:list"
                tal:attributes="value group/id;
              " />
              <a class="icon"
                title="edit"
                tal:attributes="
                  href string:${group/absolute_url}/edit;
                  title group/meta_type">
                <img tal:replace="structure python:view.render_icon(group)" />
              </a>
            </td>
            <td>
              <a class="published"
                title="edit this group"
                tal:attributes="href string:${group/absolute_url}/edit"
                i18n:attributes="title">
                <tal:block replace="group/id">
                  id
                </tal:block>
              </a>
            </td>
            <td tal:content="structure group/meta_type" />
            <td>
              <tal:block replace="structure python:mangle.DateTime(group.get_modification_datetime()).toShortStr() or default">
                -
              </tal:block>
            </td>
            <td tal:content="python:group.sec_get_last_author_info().fullname()">
              author name
            </td>
          </tr>
        </tal:define>
      </tal:repeat>
      <tr class="even">
        <td colspan="5"
          tal:condition="not:groups">
          <i i18n:translate="">
            No groups have been defined in this location.
          </i>
        </td>
      </tr>
    </tbody>
  </table>

      </td>
      <tal:block replace="nothing">
        _____________________ right column _____________________
      </tal:block>
      <td class="right">
        &nbsp;
      </td>
    </tr>
  </tbody>
</table>

</metal:block>
</metal:block>
</html>
