<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html tal:omit-tag=""
  lang="en"
  xml:lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:notal="http://www.infrae.com/silva/notal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  tal:define="
    global vein string:Groups;
    global active_tab string:tab_access;
    global parent_screen_name string:access;
    "
  i18n:domain="silva">

<metal:block use-macro="here/macro_index/macros/master">
<metal:block fill-slot="script">
  <script type="text/javascript" 
    tal:content="structure python:here.focus_editor('field_object_id')" />
</metal:block>
<metal:block fill-slot="main"
  tal:define="
    allow_authentication_requests model/service_members/allow_authentication_requests | nothing;
    has_access here/has_change_access_permission;"
  tal:condition="has_access">

<table class="columns columns3">
  <tbody>
    <tr>
      <td class="left">
        <tal:block replace="nothing">
          ______________ parent screen link ______________
        </tal:block >
        <metal:block use-macro="view/macro_vein_navigation/macros/parent" />
        <tal:block replace="nothing">
          ______________ vein navigation ______________
        </tal:block >
        <metal:use-macro use-macro="view/macro_vein_navigation/macros/vein">
          <metal:fill-slot fill-slot="sidebar">
            <tal:block replace="structure python: view.service_sidebar.render(model, 'tab_access_groups', vein)" />
          </metal:fill-slot>
        </metal:use-macro>
      </td>

      <tal:block replace="nothing">
        _____________________ main subtable _____________________
      </tal:block>
      <td class="main">

<form id="group_assets"
  name="group_assets"
  action="tab_access_groups_delete"
  method="post"
  tal:define="groups view/get_locally_defined_groups">
  <table class="listing">
    <thead>
      <tr tal:replace="nothing">
        ______________ vein + title row ______________
      </tr>
      <tr>
        <td class="top"
          colspan="5">
          <h2 tal:attributes="title string:id: ${model/id}">
            <img tal:replace="structure python:view.render_icon(model)" />
            <span i18n:translate="groups_in">groups in</span>
            &#xab;<tal:block content="title" />&#xbb;
          </h2>
        </td>
      </tr>
      <tr class="top-controls">
        <td colspan="5">
          <h3 i18n:translate="groups_located_in_folder">
            groups located in this folder
          </h3>
        </td>
      </tr>
    </thead>

    <tbody>
      <tr tal:condition="groups">
        <th class="listing-left">
        </th>
        <th i18n:translate="name">
          name
        </th>
        <th tal:replace="nothing">
          title
        </th>
        <th i18n:translate="type">
          type
        </th>
        <th i18n:translate="modified">
          modified
        </th>
        <th i18n:translate="modifier">
          modifier
        </th>
      </tr>
      <tal:repeat repeat="group groups">
        <tal:define define="iterate repeat/group/odd">
          <tr tal:attributes="class python:iterate and 'odd' or 'even'">
            <td nowrap="1">
              <input class="warning-checkbox"
                name="groupids:list"
                type="checkbox"
                value=""
                tal:attributes="value group/id;"
              />
              <a class="icon"
                title="edit"
                tal:attributes="
                  href string:${group/absolute_url}/edit;
                  title group/meta_type">
                <img tal:replace="structure python:view.render_icon(group)" />
              </a>
            </td>
            <td>
              <a class="published"
                title="edit this group"
                tal:attributes="href string:${group/absolute_url}/edit"
                i18n:attributes="title">
                <tal:block replace="group/id">
                  id
                </tal:block>
              </a>
            </td>
            <td tal:replace="nothing">
              <a class="blacklink"
                title="edit this group"
                tal:attributes="href string:${group/absolute_url}/edit"
                i18n:attributes="title">
                <tal:block replace="group/get_title">
                  title
                </tal:block>                    
              </a>
            </td>
            <td tal:content="structure group/meta_type">
              type
            </td>
            <td>
              <tal:block replace="structure python:mangle.DateTime(group.get_modification_datetime()).toShortStr() or default">
                -
              </tal:block>
            </td>
            <td tal:content="python:group.sec_get_last_author_info().fullname()">
              author name
            </td>
          </tr>
        </tal:define>
      </tal:repeat>
      <tr class="even">
        <td colspan="5"
          tal:condition="not:groups">
          <i i18n:translate="no_groups_defined_in_folder">
            No groups have been defined in this location.
          </i>
        </td>
      </tr>
    </tbody>
    <tfoot>
      <tr class="controls">
        <td colspan="5">
          <input class="warning"
            type="submit"
            value="delete"
            title="delete selected groups: alt-d"
            accesskey="d"
            onclick="return confirm('Really delete?')"
            i18n:attributes="title value onclick"
            tal:condition="groups"
          />
        </td>
      </tr>
    </tfoot>
  </table>
</form>

<tal:block replace="nothing">
  _____________________ add group _____________________
</tal:block>
<form 
  method="POST" 
  action="add_object_submit" 
  name="focusbox" 
  enctype="multipart/form-data">
  <table class="listing">
    <thead>
      <tr class="top-controls">
        <td colspan="3">
          <h3 i18n:translate="add_group">
            add a group
          </h3>
        </td>
      </tr>
    </thead>
    <tbody>
      <tr class="even">
        <td class="align-right"
          width="10%">
          id<span class="warning">*</span>
        </td>
        <td style="width: 50%;">
          <input class="store"
            type="text" 
            value="" 
            name="field_object_id" 
            size="20" 
          />
        </td>
        <td>
          No spaces or special characters besides &#8216;_&#8217; or &#8216;-&#8217; or &#8216;.&#8217;
        </td>
      </tr>
      <tr class="odd">
        <td class="align-right">
          type<span class="warning">*</span>
        </td>
        <td>
          <select class="store"
            name="meta_type">
            <option value="Silva Group">
              Group: a group defined by a list of users
            </option>
            <option value="Silva Virtual Group">
              Virtual Group: a group defined by a list of normal groups
            </option>
            <option value="Silva IP Group">
              IP Group: a group based on ip addresses
            </option>
          </select>
        </td>
        <td>
          &nbsp;
        </td>
      </tr>
    </tbody>
    <tfoot>
      <tr class="controls">
        <td class="align-right"
          colspan="3">
          <input class="button" 
            type="submit" 
            name="add_submit" 
            value="save" 
            title="access key: alt-s" 
            accesskey="s" 
            i18n:attributes="title value"
          />
          <input class="button"
            type="submit"
            name="add_edit_submit"
            value="save + edit"
            title="access key: alt-e"
            accesskey="e"
            i18n:attributes="title value"
          />
        </td>
      </tr>
    </tfoot>
  </table>
</form>

      </td>
      <tal:block replace="nothing">
        _____________________ right column _____________________
      </tal:block>
      <td class="right">
        &nbsp;
      </td>
    </tr>
  </tbody>
</table>

</metal:block>
</metal:block>
</html>
