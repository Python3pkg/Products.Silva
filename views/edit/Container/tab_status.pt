<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en"
  xml:lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  tal:define="
  breadcrumb_vein string:Publish;
  "
  i18n:domain="silva">
<metal:block use-macro="here/macro_index/macros/master">
<metal:block tal:define="
  default_doc model/get_default;
  default_doc_url default_doc/absolute_url | nothing;
  objects model/get_processed_status_tree;
  refs request/refs | options/refs | python: [];
  redisplay_timing_form request/redisplay_timing_form | options/redisplay_timing_form | python: 1;
  "
  fill-slot="main">

<form action="."
  method="POST"
  name="silvaObjects"
  tal:define="
    global approveables nothing;
    global rejectables nothing;
    global revokeables nothing;
    global closeables nothing;
    global new_versionables nothing;
    global expireables nothing;
  ">
  <table class="columns columns2">
    <tbody>
      <tr>
        <tal:block replace="nothing">
          _____________________ sidebar _____________________
        </tal:block>
        <td class="left">
          <metal:use-macro use-macro="view/macro_vein_navigation/macros/vein">
            <metal:fill-slot fill-slot="sidebar">
              <tal:block replace="structure python: view.service_sidebar.render(model, 'tab_status', breadcrumb_vein)" />
            </metal:fill-slot>
          </metal:use-macro>
        </td>

        <tal:block replace="nothing">
          _____________________ main _____________________
        </tal:block>
        <td class="main">

<table class="listing">
  <thead>
    <tal:block replace="nothing">
      ______________ vein + title row ______________
    </tal:block>
    <tr>
      <td class="top"
        colspan="6">
        <h2 tal:attributes="title string:id: ${model/id}">
          <img tal:replace="structure python:view.render_icon(model)" />
          &#xab;<span tal:replace="title">title</span>&#xbb;
        </h2>
      </td>
    </tr>
    <tal:block replace="nothing">
      ______________ top controls row ______________
    </tal:block>
    <tr class="top-controls">
      <td colspan="6" class="align-right">
        <h3 style="float:left;">
          Publishing actions
        </h3>
        <input class="navigation"
          name="tab_status_export:method"
          type="submit"
          accesskey="e"
          tal:define="type python:test(model.meta_type == 'Silva Folder', 'Folder', 'Publication')"
          tal:attributes="
            value string: Export...;
            title string:export this ${type}: alt-e;"
	       />
      </td>
    </tr>
  </thead>
  <tbody>
    <tr tal:condition="objects">
      <th class="listing-left">
        &nbsp;
      </th>
      <th>
        Edit / Preview
      </th>
      <th class="align-right">
        Revision
      </th>
      <th class="align-right">
        Publication due
      </th>
      <th class="align-right">
        Expiration due
      </th>
      <th class="align-right">
        Published
      </th>
    </tr>
    <tal:block replace="nothing">
      ______________ iteration ______________
    </tal:block>
    <tal:block repeat="obj objects">
      <tr
        tal:define="
          iterate repeat/obj/odd;
          is_container obj/implements_container | nothing;
          indent_depth python: '%spx' % str(obj['indent'] * 10);
          obj_url obj/absolute_url;
          state obj/status_style | nothing;
          global rejectables python: test(state == 'pending', 1, rejectables);
          global revokeables python: test(state == 'approved', 1, revokeables);
          global approveables python: test(state == 'draft' or state == 'closed', 1, approveables);
          global new_versionables python: test(state == 'closed', 1, new_versionables);"
        tal:attributes="
          class python: iterate and 'odd' or 'even';">
        <td class="listing-left">
          <input name="refs:list"
            type="checkbox"
            value="value"
            tal:define="ref obj/ref | nothing"
            tal:condition="ref"
            tal:attributes="
              value ref;
              checked python: ref in refs and 'checked' or nothing;
              "
          />
        </td>
        <tal:block replace="nothing">
          _______ title cell _______
        </tal:block>
        <td>
          <div tal:attributes="style string:margin-left:${indent_depth}">
            <div style="float: left;">
              <a title="edit"
                tal:attributes="href string:${obj_url}/edit/tab_edit">
                <img tal:replace="structure obj/icon" />
              </a>
            </div>
            <div style="padding-left: 19px;"
              tal:define="title obj/title">
              <a class="blacklink"
                title="preview"
                tal:attributes="
                  class obj/status_style | default;
                  href string:${obj_url}/edit/tab_preview;">
                  <i tal:condition="obj/is_default | nothing">
                    index of
                  </i>
                  <tal:block replace="title"  />
                  <tal:block condition="python:title == ''">
                    <i>no title</i>
                  </tal:block>
              </a>
            </div>
          </div>
        </td>
        <tal:block replace="nothing">
          _______ revision cell _______
        </tal:block>
        <td class="align-right">
          <a title="status"
            tal:condition="obj/status | nothing"
            tal:attributes="
              class obj/status_style | default;
              href string:${obj_url}/edit/tab_status;">
            <tal:block replace="obj/status" />
          </a>
          <a class="closed"
            title="publish"
            tal:condition="is_container"
            tal:attributes="
              href string:${obj_url}/edit/tab_status;">
            <i>n/a</i>
          </a>
        </td>
        <tal:block replace="nothing">
          _______ publication datetime cell _______
        </tal:block>
        <td class="align-right"
          tal:content="structure obj/next_version_publication_datetime | nothing">
          21 oct 2001 18:18
        </td>
        <tal:block replace="nothing">
          _______ expiration datetime cell _______
        </tal:block>
        <td class="align-right"
          tal:define="
            expire_time obj/next_version_expiration_datetime | nothing;
            global expireables python:expire_time and 1 or expireables;"
          tal:content="structure expire_time">
          21 oct 2001 18:18
        </td>
        <tal:block replace="nothing">
          _______ public version cell _______
        </tal:block>
        <td class="align-right"
          tal:define="
            public_status obj/public_status | nothing;
            start_time obj/public_version_publication_datetime | nothing;
            end_time obj/public_version_expiration_datetime | nothing">
          <a href="tab_status"
            title="public version"
            tal:attributes="href obj_url;"
            tal:condition="python: public_status == 'published'">
            <tal:block
              define="
                global closeables python: 1;
                global new_versionables python: 1"
              condition="start_time"
              replace="
                python: '%s%s' % (start_time, test(end_time, ' - %s' % end_time, ''))">
            </tal:block>
          </a>
          <tal:block 
            condition="python: public_status == 'closed'"> 
            <span i18n:translate="closed"
              define="global new_versionables python: closed and 1 or new_versionables;">
              closed
            </span>
          </tal:block>
        </td>
      </tr>
    </tal:block>
    <tal:block replace="nothing">
      ______________ if empty ______________
    </tal:block>
    <tr class="even"
      tal:condition="not: objects">
      <td 
        colspan="6">
        There are no publishable items here.
      </td>
    </tr>
  </tbody>
  <tfoot tal:condition="may_change_content">
    <tr tal:condition="objects">
      <th class="listing-left"
        colspan="2">
        <tal:define define="select_id string:refs">
          <metal:block use-macro="view/macro_select_all/macros/select_all" />
        </tal:define>
      </th>
      <th class="align-right"
        colspan="3">
        day / month / year &nbsp;23:59
      </th>
      <th>
      </th>
    </tr>
    <tr class="controls inter-controls"
      tal:condition="python:approveables or revokeables">
      <tal:block replace="nothing">
        ______________ publication time controls ______________
      </tal:block>
      <td class="align-right"
        colspan="5">
        <label title="access key: alt-m" 
          accesskey="m">
          publish time:
        </label>
        <tal:block
          condition="redisplay_timing_form"
          replace="structure python: view.tab_status_form.publish_datetime.render_from_request(request)" 
        />
        <tal:block
          tal:condition="not: redisplay_timing_form"
          tal:replace="structure python: view.tab_status_form.publish_datetime.render()" 
        />
      </td>
      <td class="align-right"
        style="vertical-align:bottom; line-height:160%; padding-bottom:0.3em;">
        <tal:block condition="may_approve_content">
          <label 
            for="publish_now_flag" 
            title="access key: alt-u" 
            accesskey="u">
            p<u>u</u>blish&nbsp;now?
          </label>
          <tal:block 
            condition="redisplay_timing_form"
            replace="structure python:view.tab_status_form.publish_now_flag.render_from_request(request)" 
          />
          <tal:block 
            condition="not: redisplay_timing_form"
            replace="structure python:view.tab_status_form.publish_now_flag.render()" 
          />
        </tal:block>
      </td>
    </tr>
    <tr class="controls inter-controls"
      tal:condition="python:approveables or revokeables or closeables">
      <tal:block replace="nothing">
        ______________ expiration time controls ______________
      </tal:block>
      <td class="align-right"
        colspan="5">
        <label title="access key: alt-x" 
          accesskey="x">
          expiration time:
        </label>
        <tal:block 
          condition="redisplay_timing_form"
          replace="structure python: view.tab_status_form.expiration_datetime.render_from_request(request)" 
        />      
        <tal:block 
          condition="not: redisplay_timing_form"
          replace="structure python: view.tab_status_form.expiration_datetime.render()" 
        />      
      </td>
      <td class="align-right"
        style="vertical-align:bottom; line-height:160%; padding-bottom:0.3em;">
        <tal:block 
          condition="python: may_approve_content and expireables">
          <label for="clear_expiration"
            title="access key: alt-p"
            accesskey="p">
            Clear&nbsp;ex<u>p</u>iration
          </label>
          <field tal:replace="structure view/tab_status_form/clear_expiration/render" />        
        </tal:block>
      </td>
    </tr>
    <tal:block replace="nothing">
      ______________ editor controls ______________
    </tal:block>
    <tr class="controls"
      tal:condition="may_approve_content">
      <td colspan="3"
        style="border-style:none;">
        <input class="reject"
          type="submit"
          name="tab_status_reject:method"
          value="Reject" 
          title="reject pending request for approval of selected objects: alt-j"
          accesskey="j"
          tal:condition="rejectables"
        />
        <input class="revoke"
          type="submit"
          name="tab_status_revoke:method"
          value="Revoke"
          title="withdraw approval of approved versions of selected objects: alt-v"
          accesskey="v"
          tal:condition="revokeables"
        />
        <input class="close"
          type="submit"
          name="tab_status_close:method"
          value="Close"
          title="close published items: alt-c"
          accesskey="c"
          tal:condition="closeables"
        />
        <input class="button" 
          type="submit" 
          name="tab_status_new_version:method" 
          value="New version" 
          title="create new versions of published docs of selected objects: alt-n" 
          accesskey="n"
          tal:condition="new_versionables"
        />
      </td>
      <td class="align-right"
        colspan="3">
        <input class="button"
          name="tab_status_change_settings:method"
          type="submit"
          value="Change timings"
          title="change publish and expiration times for selected objects: alt-s"
          accesskey="s"
          tal:condition="python:approveables or revokeables or closeables"
        />
        <input class="button"
          name="tab_status_approve:method"
          type="submit"
          value="Approve"
          title="approve or publish new versions of selected objects: alt-o"
          accesskey="o"
          tal:condition="python: approveables or rejectables"
        />
      </td>
    </tr>
    <tr class="controls"                  
      tal:condition="not:may_approve_content">
      <tal:block replace="nothing">
        ______________ author controls ______________
      </tal:block>
      <td colspan="4"
        style="border-style:none;">
        <input class="reject"
          type="submit"
          name="tab_status_withdraw:method"
          value="Withdraw"
          title="withdraw pending request for approval: alt-w"
          accesskey="w"
          tal:condition="rejectables"
        />
        <input class="revoke"
          accesskey="v"
          name="tab_status_revoke:method"
          title="revoke approval of approved versions: alt-v"
          type="submit"
          value="Revoke"
          tal:condition="revokeables"
        />
        <input class="button" 
          type="submit" 
          name="tab_status_new_version:method" 
          value="New version" 
          title="create new versions of published docs: alt-n" 
          accesskey="n"
          tal:condition="new_versionables"
        />
      </td>
      <td class="align-right"
        colspan="2">
        <input class="button"
          type="submit"
          name="tab_status_request_approval:method"
          value="Request approval"
          title="request approval for new versions: alt-r"
          accesskey="r"
          tal:condition="approveables"
        />
      </td>
    </tr>
  </tfoot>
</table>

        </td>
      </tr>
    </tbody>
  </table>
</form>
</metal:block>
</metal:block>
</html>
