<init tal:define="global model request/model;
                  global view here;
                  global silva_root here/silva_root;
                  global objects python:model.get_tree()" />

<div class="margins">
  <h2>Contents of <span class="folder-title" tal:content="structure string:&raquo;${model/get_title_html}&laquo;">title here</span></h2>
</div>

<form action="." name="silvaObjects" method="POST">
<table cellspacing="0" cellpadding="0" border="0" width="100%">
  <tr>
    <td class="divider" width="3" colspan="4"><img tal:attributes="src string:${silva_root}/globals/pixel.gif" width="1" height="1" /></td>
  </tr>

<span tal:replace="nothing"> ______________ framing table header ______________ </span>
<tr class="topcontrols" valign="bottom"> 
  <!-- top row of complete table with sidebar -->
  <td width="22%" nowrap="1">
    <img tal:attributes="src string:${silva_root}/globals/pixel.gif" width="3" height="16" /><a href="treelink" title="Up to containing publication"
      tal:condition="python:model != model.get_root()"
      tal:attributes="href python:model.aq_parent.get_publication().absolute_url() + '/edit/tab_edit'"><img width="16" height="16" border="0" alt="Up to containing Publication" hspace="3"
      tal:attributes="src python:test(model.get_publication() == model, '%s/globals/up_publication_gray.gif'%silva_root, '%s/globals/up_tree_gray.gif'%silva_root)" /></a>
    <span class="back3">Publication</span>
    <a href="../../edit/tab_edit" title="Up one level"
      tal:condition="python:model != model.get_root()"><img tal:attributes="src string:${silva_root}/globals/up_level_gray.gif" width="16" height="16" border="0" alt="Up one level" hspace="5" /></a>
  </td>
  <td class="divider"><img tal:attributes="src string:${silva_root}/globals/pixel.gif" width="1" height="22" /></td>
  <td>
    <img tal:attributes="src string:${silva_root}/globals/pixel.gif" width="3" height="16" /><img src="%s" width="16" height="16" alt="%s" 
      tal:replace="structure python:view.render_icon(model.meta_type)" />&nbsp;
    <span class="back3"><span tal:replace="model/id">id</span>
    <span tal:replace="string: (${model/get_title_html})"
        tal:condition="python:model.get_title_html() != ''">title</span>
  </td>
  <td align="right">
    <select name=":action"
      tal:attributes="onChange string:location.href='${model/absolute_url}/edit/'+this.options[this.selectedIndex].value">
      <option value="" disabled>Select...</option>
      <option value="add_document">document</option>
      <option value="add_folder">folder</option>
      <option value="add_publication">publication</option>
      <option value="add_ghost">ghost</option>
      <option value="add_image">image</option>      
      <option value="add_course">course</option>
    </select>
    &nbsp;
    <input class="button" type="submit" name="submit" value=" Add " title="Add an object to this folder" />&nbsp;&nbsp;
  </td>
</tr>

<span tal:replace="nothing"> _____________________ sidebar _____________________ </span>

<tr class="focus" valign="top">
  <td>
    <!-- inner table for sidebar -->
    <table cellspacing="0" cellpadding="1" border="0" width="100%">
<span tal:replace="nothing"> ______________ publication header ______________ </span>
      <tr>
        <th align="left"
          tal:attributes="class python:test(model == model.get_publication(), 'focus-light', nothing)">
          <img tal:attributes="src string:${silva_root}/globals/pixel.gif" width="1" height="16" />
          <a href="top" title="Up to publication top" 
            tal:define="url python:model.get_publication().absolute_url()"
            tal:attributes="href string:${url}/edit/tab_edit"><img tal:attributes="src string:${silva_root}/globals/silvapublication.gif" width="16" height="16" border="0" alt="Silva Publication" /></a>
          <a class="blacklink" href="top" title="Up to publication top" tal:define="url python:model.get_publication().absolute_url()"
            tal:attributes="href string:${url}/edit/tab_edit"><span tal:replace="python:model.get_publication().get_title_html()">Publication top</span></a>
        </th>
      </tr>

<span tal:replace="nothing"> ______________ pub folders ______________ </span>
      <rowset tal:omit-tag=""
        tal:repeat="indent_item python:model.get_publication().get_container_tree()">
        <tr tal:define="item python:indent_item[1]; indent python:indent_item[0]; 
          oddrow repeat/indent_item/odd">
          <td class="highlight"
            tal:attributes="class python:test(model == item, 'focus-light', 'focus')">
            <img width="5" height="5" tal:attributes="width python:indent * 16 + 21; src string:${silva_root}/globals/pixel.gif" />
            <a href="folder" title="Edit folder"
              tal:attributes="href string:${item/absolute_url}/edit/tab_edit"><img src="%s" width="16" height="16" alt="%s" 
              tal:replace="structure python:view.render_icon(item.meta_type)" /></a>
            <a class="blacklink" href="title" title="id"
              tal:attributes="href string:${item/absolute_url}/edit/tab_edit;
                              title string:id: ${item/id}">
              <span tal:replace="item/get_title_html | default">no title</span>
            </a>
          </td>
        </tr>
      </rowset>
    </table>
  </td>
  <td class="divider"><img tal:attributes="src string:${silva_root}/globals/pixel.gif" width="1" height="1" /></td>

  <td class="focus-cycle" colspan="2">
    <!-- inner table with folder view -->

<span tal:replace="nothing"> _____________________ folder subtable _____________________ </span>

<table cellspacing="0" cellpadding="3" border="0" width="100%">
<span tal:replace="nothing"> ______________ listing header ______________ </span>
<tr   tal:condition="python:len(objects) != 0 or model.get_default()">
  <th align="left" width="1%">
    #
  </th>
  <th align="left" width="2%">
    Type
  </th>
  <th align="left">
    Name
  </th>
  <th align="left" width="15%">
    Modified&nbsp;date
  </th>
  <th align="left" width="15%">
    Author
  </th>
  <th align="right" width="2%">
    Shift&nbsp;&nbsp;
  </th>
</tr>

<span tal:replace="nothing"> ______________ default row ______________ </span>
<!-- default -->
<tr class="focus" tal:condition="model/get_default" tal:define="default model/get_default">
  <td align="right">
    0
  </td>
  <td nowrap="1">
    <input type="checkbox" name="ids:list" value="value" 
      tal:attributes="value default/id" />
    <a href="default" title="Edit this item"
      tal:attributes="href python:default.absolute_url()+ '/edit/tab_edit'"><img tal:replace="structure python:view.render_icon(default.meta_type)" /></a>
  </td>
  <td>
    <a class="blacklink" href="default" title="Edit this item"
      tal:attributes="href python:default.absolute_url() + '/edit/tab_edit';
                      class python:view.get_status_style(default)" 
      tal:content="default/id">
      Default
    </a>
    <span tal:condition="python:default.is_version_published() or default.is_version_approved()">
      <img tal:attributes="src string:${silva_root}/globals/checkmark.gif" width="10" height="10" border="0" alt="Content approved or published" />
    </span>
  </td>
  <td>
    <span tal:condition="python:default.get_modification_datetime() != None"
      tal:replace="structure python:view.service_utils.backend_short_datetime_to_str(default.get_modification_datetime())">21 oct 2001 18:18</span>
    <span tal:condition="python:default.get_modification_datetime() == None">&nbsp;</span>
  </td>
  <td tal:content="python:default.sec_get_last_author_info()['cn']">
    Author
  </td>
  <td>
    &nbsp;
  </td>
</tr>

<span tal:replace="nothing"> _____________________ publishables _____________________ </span>

<span tal:replace="nothing"
  tal:define="global publishables python:model.get_ordered_publishables()"> 
  ______________ listing iteration ______________ </span>
<rowset tal:omit-tag="" tal:repeat="item publishables">
<cycle tal:omit-tag="" tal:define="oddrow repeat/item/odd">
<!-- iteration over ordered publishables -->
<tr class="focus-cycle" tal:attributes="class python:test(oddrow, 'focus', 'focus-cycle')">
  <span tal:replace="nothing"> _______ position cell _______ </span>
  <td align="right" tal:content="repeat/item/number">
    #
  </td>
  <span tal:replace="nothing"> _______ checkbox + icon cell _______ </span>
  <td nowrap="1">
    <input type="checkbox" name="ids:list" value="value" 
      tal:attributes="value item/id" />
    <a href="object" title="Edit this item" 
      tal:attributes="href string:${item/absolute_url}/edit/tab_edit"><img tal:replace="structure python:view.render_icon(item.meta_type)" /></a>
  </td>
  <span tal:replace="nothing"> _______ id + title cell _______ </span>
  <td>
    <a title="Edit this item"
      tal:attributes="href string:${item/absolute_url}/edit/tab_edit; 
      class python:view.get_status_style(item)">
      <span tal:replace="item/id">id</span>&nbsp;
      <span tal:replace="string:(${item/get_title_html})"
        tal:condition="python:item.get_title_html() != ''">title</span>
    </a>
    <span tal:condition="python:item.implements_versioned_content()
                         and (item.is_version_published()
                         or item.is_version_approved())">
      <img tal:attributes="src string:${silva_root}/globals/checkmark.gif" width="10" height="10" border="0" alt="Content approved or published" title="Content approved or published" />
    </span>
  </td>
  <span tal:replace="nothing"> _______ modification date cell _______ </span>
  <td>
    <span tal:condition="python:item.get_modification_datetime() != None"
      tal:replace="structure python:view.service_utils.backend_short_datetime_to_str(item.get_modification_datetime())">21 oct 2001 18:18</span>
    <span tal:condition="python:item.get_modification_datetime() == None" tal:omit-tag="">
<a class="graylink" title="Down to Publish tab of publication"
  tal:attributes="href string:${item/absolute_url}/edit/tab_status">
<img tal:attributes="src string:${silva_root}/globals/pixel.gif" width="16" height="16" border="0" alt="Down to Publish tab of folder" /></a>
</span>
  </td>
  <span tal:replace="nothing"> _______ author cell _______ </span>
  <td>
    <span tal:content="python:item.sec_get_last_author_info()['cn']">
    author&nbsp;name</span>
    <span tal:condition="python:item.sec_get_last_author_info()['cn'] == ''">&nbsp;</span>
  </td>
  <span tal:replace="nothing"> _______ move buttons _______ </span>
  <td width="36px" align="right">
    <a href="" title="Move down"
      tal:attributes="href string:${model/absolute_url}/edit/tab_edit_move_down?id=${item/id}"><img tal:attributes="src string:${silva_root}/globals/down.gif" width="16" height="12" alt="Move down" border="0" /></a>
    <a href="" title="Move up"
      tal:attributes="href string:${model/absolute_url}/edit/tab_edit_move_up?id=${item/id}"><img tal:attributes="src string:${silva_root}/globals/up.gif" width="16" height="12" alt="Move up" border="0" /></a>
  </td>
</tr>
</cycle>
</rowset>

<span tal:replace="nothing"> ______________ if no active publishables in this folder ______________ </span>
<tr class="focus-light" 
  tal:condition="python:len(objects) == 0 and not model.get_default()">
<td colspan="6">
<img tal:attributes="src string:${silva_root}/globals/pixel.gif" width="16" height="12" />&nbsp;
There are no active content objects in this folder.
</td>
</tr>

<span tal:replace="nothing"> ______________ deactivate + move + P <-> F ______________ </span>
<tr class="controls-cycle"
  tal:condition="python:len(publishables)">
  <td colspan="7">
    <input class="button" type="submit" name="tab_edit_deactivate:method" value="Deactivate" title="Remove items from the publication Table of Contents"
      tal:condition="python:len(publishables)" />                
    <can_move tal:condition="python:len(publishables) > 1" tal:omit-tag="">&nbsp;&nbsp;<span class="widebody">Move selected item(s) to position:</span>
      <select name="new_position">
        <selection_set tal:repeat="item publishables">
          <option value="0" tal:attributes="value repeat/item/number"
            tal:content="repeat/item/number" />
        </selection_set>
        <option value="0"                     
          tal:attributes="value python:len(publishables) + 1">end</option>
      </select>&nbsp;&nbsp;&nbsp;<input class="button" type="submit" name="tab_edit_move_to:method" value="Move" title="Move item(s) into selected position" />&nbsp;&nbsp;
    </can_move>
    <input class="button" type="submit" name="transform_folder_to_pub:method" value="Folder <-> Pub" title="Transform folders to publications and back" />
    <span tal:condition="python:len(publishables) <= 1">&nbsp;</span>
  </td>
</tr>

<span tal:replace="nothing"> _____________________ deactivated _____________________ </span>

<span tal:replace="nothing"
  tal:define="global nonactives python:model.get_nonactive_publishables()">
  ______________ deactivated publishables ______________ </span>

<rowgroup tal:condition="python:len(nonactives)" tal:omit-tag="">

<tr>
  <th align="left" colspan="7">
    Deactivated content
  </th>
</tr>

<rowset tal:omit-tag="" tal:repeat="item nonactives">
<cycle tal:omit-tag="" tal:define="oddrow repeat/item/odd">
<tr class="focus-cycle" tal:attributes="class python:test(oddrow, 'focus', 'focus-cycle')">
  <td>
    &nbsp;
  </td>
  <span tal:replace="nothing"> _______ checkbox + icon cell _______ </span>
  <td nowrap="1">
    <input type="checkbox" name="ids:list" value="value" 
      tal:attributes="value item/id" />
    <a href="object" title="Edit this (nonactive) item"
      tal:attributes="href string:${item/absolute_url}/edit/tab_edit"><img tal:replace="structure python:view.render_icon(item.meta_type)" /></a>
  </td>
  <span tal:replace="nothing"> _______ id + title cell _______ </span>
  <td>
    <a href="object" title="Edit this (nonactive) item" 
      tal:attributes="href string:${item/absolute_url}/edit/tab_edit; 
                      class python:view.get_status_style(item)">
      <span tal:replace="item/id">id</span>&nbsp;
      <span tal:replace="string:(${item/get_title_html})"
        tal:condition="python:item.get_title_html() != ''">title</span>
    </a>
  </td>
  <span tal:replace="nothing"> _______ modification date cell _______ </span>
  <td>
    <span tal:condition="python:item.get_modification_datetime() != None"
      tal:replace="structure python:view.service_utils.backend_short_datetime_to_str(item.get_modification_datetime())">21 oct 2001 18:18</span>
    <span tal:condition="python:item.get_modification_datetime() == None" tal:omit-tag="">&nbsp;</span>
  </td>
  <span tal:replace="nothing"> _______ author cell _______ </span>
  <td tal:content="python:item.sec_get_last_author_info()['cn']">    
    author name
  </td>
  <td>
    &nbsp;
  </td>
</tr>
</cycle>
</rowset>

<span tal:replace="nothing"> ______________ activate ______________ </span>
<tr class="controls-cycle">
  <td colspan="7">
    <input class="button" type="submit" name="tab_edit_activate:method" value="Activate" title="Return items to the publication Table of Contents" />
  </td>
</tr>

</rowgroup>

<span tal:replace="nothing"> _____________________ assets _____________________ </span>

<span tal:replace="nothing"
    tal:define="global assets python:model.get_assets()">
    ______________ assets ______________ </span>

<rowgroup tal:condition="python:len(assets)" tal:omit-tag="">

<tr>
  <th align="left" colspan="7">
    Assets
  </th>
</tr>

<rowset tal:omit-tag="" tal:repeat="asset assets">
<cycle tal:omit-tag="" tal:define="oddrow repeat/asset/odd">
<tr class="focus-cycle" tal:attributes="class python:test(oddrow, 'focus', 'focus-cycle')">
  <td>
    &nbsp;
  </td>
  <span tal:replace="nothing"> _______ checkbox + icon cell _______ </span>
  <td nowrap="1">
    <input type="checkbox" name="ids:list" value="value" 
      tal:attributes="value asset/id" />
    <a href="asset" title="Edit this asset"
      tal:attributes="href string:${asset/absolute_url}/edit/tab_edit"><img tal:replace="structure python:view.render_icon(asset.meta_type)" /></a>
  </td>
  <span tal:replace="nothing"> _______ id + title cell _______ </span>
  <td> 
    <a class="blacklink" href="asset" title="Edit this asset"
      tal:attributes="href string:${asset/absolute_url}/edit/tab_edit">
      <span tal:replace="asset/id">id</span>&nbsp;
      <span tal:replace="string:(${asset/get_title_html})"
        tal:condition="python:asset.get_title_html() != ''">title</span>
    </a>
  </td>
  <span tal:replace="nothing"> _______ modification date cell _______ </span>
  <td>
    <span tal:condition="python:asset.get_modification_datetime() != None"
      tal:replace="structure python:view.service_utils.backend_short_datetime_to_str(asset.get_modification_datetime())">21 oct 2001 18:18</span>
    <span tal:condition="python:asset.get_modification_datetime() == None" tal:omit-tag="">&nbsp;</span>
  </td>
  <span tal:replace="nothing"> _______ author cell _______ </span>
  <td tal:content="python:asset.sec_get_last_author_info()['cn']">
    author name
  </td>
  <td>
    &nbsp;
  </td>
</tr>
</cycle>
</rowset>
</rowgroup>

<span tal:replace="nothing"> ______________ controls ______________ </span>
<tr class="controls">
  <td colspan="7" align="left">
	<span tal:omit-tag="" tal:condition="python:(len(publishables) or len(assets) or len(nonactives))">
  <script type="text/javascript">
  <!-- 
  if (document.forms[0]) {
    document.write('<input class="button" type="button" name="selectButton" value="Select all" title="Select all items in this folder" onClick="toggleSelect(); return false">')
  }
  //-->
  </script>	
  &nbsp;&nbsp;<input class="button" type="submit" name="tab_edit_rename:method" value="Rename" title="Rename and retitle an item" />
  &nbsp;&nbsp;<input class="warningbutton" type="submit" name="tab_edit_delete:method" value="Delete" title="There's no undo" onClick="return confirm('Really delete?')" />
  &nbsp;&nbsp;<input class="button" type="submit" name="tab_edit_cut:method" value="Cut" title="Cut items" />  
	&nbsp;&nbsp;<input class="button" type="submit" name="tab_edit_copy:method" value="Copy" title="Copy items" />
	</span>
	<span tal:omit-tag="" tal:condition="python:request.has_key('__cp')">
  &nbsp;&nbsp;<input class="button" type="submit" name="tab_edit_paste:method" value="Paste" title="Paste items" />
  &nbsp;&nbsp;<input class="button" type="submit" name="tab_edit_paste_to_ghost:method" value="Paste as ghost" title="Paste (items on clipboard) as ghost objects" />
	</span>
  </td>
</tr>
</table>

  </td>
</tr>

<tr>
  <td class="divider" colspan="4"><img tal:attributes="src string:${silva_root}/globals/pixel.gif" width="1" height="1" /></td>
</tr>
</table>
</form>
<script type="text/javascript">
    <!-- 
    isSelected = false;

    function toggleSelect() {
      if (isSelected == false) {
        for (i = 0; i < document.silvaObjects.length; i++)
          document.silvaObjects.elements[i].checked = true ;
        isSelected = true;
        document.silvaObjects.selectButton.value = "Deselect all";
        return isSelected;
      }
      else {
        for (i = 0; i < document.silvaObjects.length; i++)
          document.silvaObjects.elements[i].checked = false ;
        isSelected = false;
        document.silvaObjects.selectButton.value = "Select all";
        return isSelected;       
      }
    }
    //-->
    </script>
