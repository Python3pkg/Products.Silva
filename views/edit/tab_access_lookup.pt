<!-- _________________ START SETTINGS WORKSHEET ________________________ -->
<tal:block define="
  global active_tab string:tab_access;
  global breadcrumb_vein string:Lookup;
  " />
<metal:block use-macro="here/macro_index/macros/master">
<div class="margins" metal:fill-slot="main">
<h3><a href="tab_access" title="Up to top of Access tab">Access
  <img tal:attributes="src string:${silva_root}/globals/up_gray.gif" width="16" height="11" border="0" alt="Up to top of Access tab" /></a></h3>
<h2 class="worksheet">
  Users lookup
</h2>
<div class="worksheet borders top bottom left right"  
  tal:condition="python:view.has_access()"
  tal:define="global no_entry string:-">
<table width="100%" cellspacing="0" cellpadding="5" border="0">
<tr>
  <td><h3>Search</h3></td>
  <td><h3>Selection</h3></td>
</tr>
<tr align="left" valign="top">
<td width="50%">
<form action="." method="POST">
<table width="100%" cellspacing="0" cellpadding="3" border="0">
<tr class="topcontrols">
  <th colspan="2" align="left">
    <span class="tablehead4">User search</span>
  </th>
</tr>
<tr class="focus">
  <td class="rowhead" colspan="2" >
    Name (or part of name):
    <br />
    <input type="text" class="textarea" name="name" value="" style="width:100%;" />
  </td>
</tr>
<tr class="controls">
  <td>
    <input class="cancelbutton" type="submit" name="tab_access:method" value="Cancel" title="Cancel - ctrl-c" accesskey="c" />
  </td>
  <td align="right">
    <input type="submit" class="button" name="lookup_search:method" value="Search" title="Search - ctrl-s" accesskey="s" />
  </td>
</tr>
<tr>
  <td colspan="2" align="left">
    &nbsp;
  </td>
</tr>
<!-- __________________________ search results ______________________________ -->
<tr class="topcontrols">
  <th colspan="2" align="left">
    <span class="tablehead4">Search results</span>
  </th>
</tr>
<tal:block define="global lookup_result python:view.lookup_get_search_result()" />
<!-- If many items in result; put a second button on top as well. 
Is this UI-wise "done" or "not done"? -->
<tr class="topcontrols"
  tal:condition="python:len(lookup_result) > 3" >
  <td colspan="2" align="right">
    <img src="pixel.gif" width="1px" height="18px"
      tal:attributes="src string:${silva_root}/globals/pixel.gif" />
    <input type="submit" class="button" name="lookup_add_to_selection:method" value="Add to selection" title="Add checked users to your selection list on the right - ctrl-a" accesskey="a" />
  </td>
</tr>
<!-- Listing loop -->
<tal:block   
  repeat="member lookup_result">
<tr class="focus"
  tal:define="oddrow repeat/member/odd"
  tal:attributes="class python:test(oddrow, 'focus-cycle', 'focus')">
  <td align="left" valign="top" width="1%">
    <input type="checkbox" name="userids:list" value=""
      tal:attributes="value member/userid" />
  </td>
  <td>
    <span class="subhead" tal:content="member/fullname" />&nbsp;
    <br />
    <span class="subhead">email:</span>
    <span tal:replace="member/email | no_entry" /><br />
    <span class="subhead">Department(s):</span>
    <span tal:replace="python:view.lookup_render_departments(member)" /><br />
  </td>            
</tr>
</tal:block>
<tr class="focus"
  tal:condition="python:not lookup_result" >
  <td colspan="2" align="left" valign="top">
    <i>(no search results)</i>
  </td>
</tr>
<tr class="controls">
  <td colspan="2" align="right">
    <input type="submit" class="button" name="lookup_add_to_selection:method" value="Add to selection" title="Add checked users to your selection list on the right - ctrl-a" accesskey="a" />
  </td>
</tr>
</table>
</form>
</td>
<!-- __________________________ selection ______________________________ -->
<td width="50%">
<form action="." method="POST">
<table width="100%" cellspacing="0" cellpadding="3" border="0">
<tr class="topcontrols">
  <th align="left">
    <span class="tablehead4">Current selection</span>
  </th>
  <th align="right">
    <input type="submit" name="lookup_use_selection:method" class="button" value="Use selection..." title="Return to the top of the access tab with this selection - ctrl-u" accesskey="u" />
  </th>
</tr>
<tal:block define="selected_members python:here.lookup_get_selection().values()">
  <tal:block
    tal:condition="selected_members"
    tal:repeat="member selected_members">
<tr class="focus">
  <td colspan="2" align="left">
    <input type="checkbox" class="warningbox" name="ruserids:list" value="" 
      tal:attributes="value string:${member/userid}"/>&nbsp;
      <span class="subhead" tal:content="member/fullname" />&nbsp;
      <br />
  </td>
</tr>
</tal:block>
</tal:block>
<tr class="controls">
  <td colspan="2" align="left">
    <input type="submit" name="lookup_remove_from_selection:method" class="warningbutton" value="Deselect" title="Remove users from your selection - ctrl-d" accesskey="d">
  </td>
</tr>
</table>
</form>
</td>
<!-- ________________________ end selection ____________________________ -->
</tr>
</table>
</div>
</div>
</metal:block>
<!-- _____________________ END SETTINGS WORKSHEET ______________________ -->
