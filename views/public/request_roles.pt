<html metal:use-macro="here/layout_macro.html/macros/layout">
  <head>
    <title tal:content="template/title">The title</title>
  </head>
  <body>

<div metal:fill-slot="main" tal:define="dummy here/security_trigger" tal:omit-tag="">

<tal:block condition="python: hasattr(here, 'service_members') and here.service_members.allow_subscription()">

<!-- __________________________ feedback _________________________ -->
<tal:block
  define="msg options/message | nothing"
  condition="msg">
<div class="alert" style="margin:0%;">
<span tal:replace="structure msg">message</span>
</div>
</tal:block>

<h2>Membership</h2>

<tal:define define="global view here; global member python: view.service_members.get_member(view.REQUEST.AUTHENTICATED_USER.getId())" />

<form action="request_roles_submit" method="POST"
  tal:condition="python: not member.email() or not member.fullname()">
<input type="hidden" name="last_url" tal:attributes="value view/REQUEST/last_url" />

<div class="hilight borders top right bottom left"
  style="padding: 0.2em 0.5em 1em 0.5em; clear: both; width: 20em; line-height:1.1em;">
<span class="subhead">Request roles at this location</span><br /><br />
Please fill in the following fields.<br /><br />

Full name:<br />
<input type="text" name="fullname" style="width: 100%;"
 tal:attributes="value member/fullname" /><br /><br />

E-mail address:<br />
<input type="text" name="email" style="width: 100%;"
 tal:attributes="value member/email" /><br /><br />

Choose role(s) to request:<br />
<tal:repeat repeat="role view/get_available_roles">
<input type="checkbox" name="roles:list" 
 tal:attributes="
  value role;
  id role;" />&nbsp;<label tal:attributes="for role" tal:content="role">Role</label><br />
</tal:repeat>

<input class="button" type="submit" value=" Send request " 
  title="Send request for role: alt-s" accesskey="s" style="float:right;" />
<br />
</div>

</form>

</tal:block>
<tal:block condition="python: not hasattr(here, 'service_members') or not here.service_members.allow_subscription()">

This site does not allow requests for roles.

</tal:block>

</div>

  </body>
</html>
