<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html tal:omit-tag=""
  lang="en"
  xml:lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:notal="http://www.infrae.com/silva/notal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  tal:define="
    global vein string:add;
    global active_tab string:tab_edit;
    lookup_mode request/lookup_mode | python:0;
    use_macro python: (lookup_mode and [here.macro_no_tabs] or [here.macro_index])[0]"
  i18n:domain="silva">
<metal:block use-macro="use_macro/macros/master">
<metal:block fill-slot="script">
  <script type="text/javascript" 
            tal:attributes="src here/reference.js/absolute_url">
  </script>
</metal:block>
<metal:block fill-slot="main">
<script type="text/javascript" 
  tal:content="structure python:here.focus_editor('field_object_id')" />

<div class="focus-rectangle">
<form name="focusbox" action="add_object_submit" method="POST" enctype="multipart/form-data">
<input type="hidden" name="meta_type" tal:attributes="value request/meta_type" />
<input type="hidden" name="lookup_mode:int" value="0"
  tal:attributes="value lookup_mode" />
<table class="listing">
<thead>
  <tr>
    <td class="top location" colspan="3">
    <h2>
      <img tal:replace="structure python:view.render_icon_by_meta_type(request.meta_type)" />&nbsp;
      <tal:block i18n:translate="">create <span tal:replace="python: request.meta_type" i18n:name="meta_type" /></tal:block>
    </h2>
    </td>
  </tr>
</thead>

<tbody>
  <tr>
    <th class="align-right" i18n:translate="">
      attributes
    </th>
    <th style="width:50%;" i18n:translate="">
      content
    </th>
    <th i18n:translate="">
      notes
    </th>
  </tr>

  <tal:repeat repeat="field here/form/get_fields">
  <tal:define define="oddrow repeat/field/odd">
  <tr tal:attributes="class python:test(oddrow, 'odd', 'even')">
    <td class="align-right">
      <tal:block tal:condition="python:field.getId() != 'content_url'">
        <span tal:replace="structure field/title" /><span class="warning"
          tal:condition="field/is_required">*</span>
      </tal:block>
      <tal:block tal:condition="python:field.getId() == 'content_url'">
        <input class="transport"
          type="button"
          value="reference..."
          title="find the content this ghost should refer to: alt-r"
          accesskey="r"
          tal:define="asset_context model"
          tal:attributes="onclick string: reference.getReference(
                                    function(path, id, title) {
                                      document.getElementsByName(
                                        'field_content_url'
                                      )[0].value = path;;
                                    },
                                    '${asset_context/absolute_url}',
                                    'Content', true)"
          i18n:attributes="value;title;accesskey reference_accesskey"
        /><span class="warning"
          tal:condition="field/is_required">*</span>
      </tal:block>
    </td>
    <td tal:content="structure python:field.render_from_request(request)">
      <input />
    </td>
    <td>
      <tal:block content="structure field/description" i18n:translate="">note</tal:block>
      &nbsp;
    </td>
  </tr>
  </tal:define>
  </tal:repeat>
</tbody>

<tfoot>
  <tr class="controls">
    <td class="align-right"
      colspan="3">
      <input class="cancel"
        style="float:left;"
        type="submit"
        name="add_cancel"
        value="cancel"
        title="access key: alt-c"
        accesskey="c"
        i18n:attributes="value;title;accesskey cancel_accesskey"
      />
      <input class="button"
        type="submit"
        name="add_submit"
        value="save"
        title="access key: alt-s"
        accesskey="s"
        i18n:attributes="value;title;accesskey save_accesskey"
      />
      <tal:condition condition="python: not lookup_mode" >
      <!--XXX: Here be i18n issues:-->
      <input class="button"
        type="submit"
        name="add_edit_submit"
        value="save + edit"
        title="access key: alt-e"
        accesskey="e"
        tal:attributes="value python:test(here.id in ('Folder','Publication'), 'save + enter', 'save + edit')"
        i18n:attributes="value;title;accesskey save_and_edit_accesskey"
      />
      </tal:condition>
    </td>
  </tr>
</tfoot>
</table>
</form>

</metal:block>
</metal:block>
</html>
