<html tal:omit-tag=""
  lang="en"
  xml:lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:notal="http://www.infrae.com/silva/notal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  i18n:domain="silva"
  tal:define="    
    model           request/model;
    publication     model;
    tree            publication/get_container_tree;
    publication_url string:${publication/absolute_url}/edit/{__vein_id__};
">



<tr tal:replace="nothing"> 
  ______________ stack publication row ______________ 
</tr>
<tr>
  <td class="{__class__}"
    style="border-top:none;">
    <a class="right slide-links" 
      title="slide to the publish screen"
      tal:attributes="href string:${publication/absolute_url}/edit/tab_status"
      i18n:attributes="title">
      &nbsp;
    </a>
    <a class="navicon"
      title="up to top contents of publication"
      tal:attributes="href string:${publication/absolute_url}/edit/{__vein_id__};"
      i18n:attributes="title">
      <img tal:replace="structure python:here.render_icon(model.get_publication())" />
    </a>
    <div class="normal">
      <a class="blacklink"
        href="top"
        title="up to top of publication"
        tal:attributes="href publication_url"
        tal:content="python: publication.get_short_title_editable() == '' and publication.id or publication.get_short_title_editable()"
        i18n:attributes="title">
        Publication
      </a>
    </div>
  </td>
</tr>

<span tal:replace="nothing">
  ______________ stack iteration ______________
</span>

<tal:block repeat="indent_item tree">
  <tr tal:define="
    item   python:indent_item[1];
    indent python:indent_item[0];
    ">
    <td class="{__class__}"
      tal:define="
        item_url string:${item/absolute_url};
        vein_url string:${item_url}/edit/{__vein_id__};
        title    item/get_short_title_editable">
      <a class="right slide-links" 
        title="slide to the publish screen"
        tal:attributes="href string:${item_url}/edit/tab_status"
        i18n:attributes="title">
        &nbsp;
      </a>
      <a class="left slide-links"
        title="slide to the contents screen"
        tal:attributes="href string:${item_url}/edit"
        i18n:attributes="title">
        &nbsp;
      </a>
      <a class="navicon"
        tal:attributes="
          href  string:${vein_url};
          style python:'padding-left:'+str(indent * 10 + 4)+'px';
          title item/meta_type;
        "
        i18n:attributes="title">
        <img tal:replace="structure python:here.render_icon(item)" />
      </a>
      <div class="normal">
        <a class="blacklink"
          tal:attributes="
            href string:${vein_url};
            title string:id: ${item/id};"
          tal:content="title">
          title
        </a>
        <a class="normal"
          tal:attributes="
            href string:${vein_url};
            title string:id: ${item/id};"
          tal:condition="python:title == ''"
          tal:content="item/id"
          i18n:translate="">
            no title
        </a>
      </div>
    </td>
  </tr>
  <tr class="controls"
    tal:condition="repeat/indent_item/end">
    <td style="border-top:1px solid #abc">
    </td>
  </tr>
</tal:block>

</html>
