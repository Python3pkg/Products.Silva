<html>
  <head>
    <link rel="stylesheet" href="globals/base.css" />
    <title>System problem</title>
  </head>
  <body>
    <div class="margins" tal:condition="python:options.has_key('message_type')">
      <div class="feedback" tal:condition="python:options['message_type'] == 'feedback'">
        <span tal:replace="structure python:options['message']" />&nbsp;&nbsp;<span tal:replace="string:(${here/service_utils/backend_now_to_str})">datetime</span>
      </div>
      <div class="feedback" tal:condition="python:options['message_type'] == 'error'">
        <span class="error" tal:content="structure python:options['message']" />
      </div>
    </div>
    <div class="margins" tal:condition="python: (options['error_type'] == 'Unauthorized' and here.service_members.allow_subscription())">
      You are not allowed to view this page without the right credentials. If you have a valid login for this part of the site, click the refresh button on your webbrowser's toolbar to retry logging in. If not, choose one of the following options:<br /><br />
      <a href="become_visitor">Click here to become a visitor to the site. As a visitor, you can view certain objects unauthenticated users can't view.</a><br /><br />
      <a href="request_roles">If you already are a visitor, click here to request a role which allows access to the current object. Note that you have to be a visitor to apply for roles.</a><br /><br />
      <span style="color: red; font-weight: bold;">Error: <span tal:replace="options/error_value" /></span>
    </div>
    <div class="margins" tal:condition="python: (options['error_type'] != 'Unauthorized' or not here.service_members.allow_subscription())">

      <h2>System problem</h2>
      <p>Something went wrong. If you're testing, the information below is important. <br />
        <span class="error">Please note what you were doing when this error occured.</span></p>
        <p>In any case, you can use your back button to return to the previous page.</p>
        <p>Sorry for the irritation.</p>

        <hr noshade />
        <h4>Error Type: <span class="error" tal:content="structure options/error_type|string:unknwon">error_type</span></h4>
        <h4>Error Value: <span class="error" tal:content="structure options/error_value|string:unknown"></span></h4>

        <h4>Zope reported an error for:</h4>
        Path: <span class="error" tal:content="request/PATH_INFO|string:unknown">error</span> <br />
        URL: <span class="error" tal:content="request/SERVER_URL|string:unknown" /><span class="error" tal:content="request/PATH_INFO|string:unknown" /><span tal:replace="request/QUERY_STRING|string:unknown" />
        <br />

        <h4>Client:</h4>
        Browser: <span class="error" tal:content="request/HTTP_USER_AGENT|string:unknown">error</span><br />
        Remote address: <span class="error" tal:content="request/REMOTE_ADDR|string:unknown">error</span><br />
        Remote identity: <span class="error" tal:content="request/REMOTE_IDENT|string:unknown">error</span><br />

        <h4>Linked from:</h4>
        <span class="error" tal:content="request/HTTP_REFERER|string:unknown">error</span>
        <br />

        <hr noshade />
    </div>
  </body>
</html>